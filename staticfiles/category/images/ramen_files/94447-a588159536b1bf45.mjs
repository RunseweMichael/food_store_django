(self.modernJsonp=self.modernJsonp||[]).push([["94447"],{650345:function(e,t,n){var i,o;n.r(t),n.d(t,{default:()=>l});let a={fragment:{argumentDefinitions:i=[{defaultValue:null,kind:"LocalArgument",name:"userDidItData"}],kind:"Fragment",metadata:null,name:"CommentThreadContainerLikeMutation",selections:o=[{alias:null,args:[{fields:[{kind:"Variable",name:"userDidItData",variableName:"userDidItData"}],kind:"ObjectValue",name:"input"}],concreteType:null,kind:"LinkedField",name:"v3LikeUserDidItDataMutation",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:i,kind:"Operation",name:"CommentThreadContainerLikeMutation",selections:o},params:{id:"0e45555e33d7c8c17de577cb4e5213ff3568b1b3f3e6694041407c0dad67674d",metadata:{},name:"CommentThreadContainerLikeMutation",operationKind:"mutation",text:null}};a.hash="6abad0b1546231dd9301ca5510fb88f5";let l=a},206e3:function(e,t,n){var i,o;n.r(t),n.d(t,{default:()=>l});let a={fragment:{argumentDefinitions:i=[{defaultValue:null,kind:"LocalArgument",name:"userDidItData"}],kind:"Fragment",metadata:null,name:"CommentThreadContainerUnLikeMutation",selections:o=[{alias:null,args:[{fields:[{kind:"Variable",name:"userDidItData",variableName:"userDidItData"}],kind:"ObjectValue",name:"input"}],concreteType:null,kind:"LinkedField",name:"v3UnlikeUserDidItDataMutation",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],type:"Mutation",abstractKey:null},kind:"Request",operation:{argumentDefinitions:i,kind:"Operation",name:"CommentThreadContainerUnLikeMutation",selections:o},params:{id:"8f06f078d5b50aa7a3b5e86afda41af9f9ff89d14d2620f3f830abe11ce26f6e",metadata:{},name:"CommentThreadContainerUnLikeMutation",operationKind:"mutation",text:null}};a.hash="e8e5a11ac4f4d2e8c4a2ed9c7ee3c073";let l=a},316387:function(e,t,n){var i,o;n.r(t),n.d(t,{default:()=>l});let a=(o=[i={alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null}],{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"CommentThreadContainer_pin",selections:[{alias:null,args:null,concreteType:"AggregatedPinData",kind:"LinkedField",name:"aggregatedPinData",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"commentCount",storageKey:null},{alias:null,args:null,concreteType:"AggregatedDidItData",kind:"LinkedField",name:"didItData",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"imagesCount",storageKey:null}],storageKey:null},i],storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"closeupAttribution",plural:!1,selections:[i,{alias:null,args:null,kind:"ScalarField",name:"username",storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"commentsDisabled",storageKey:null},i,{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"pinner",plural:!1,selections:o,storageKey:null},{alias:null,args:null,concreteType:"StoryPinData",kind:"LinkedField",name:"storyPinData",plural:!1,selections:o,storageKey:null},{alias:null,args:null,concreteType:"Video",kind:"LinkedField",name:"videos",plural:!1,selections:[{alias:null,args:null,concreteType:"VideoList",kind:"LinkedField",name:"videoList",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"__typename",storageKey:null}],storageKey:null}],storageKey:null}],type:"Pin",abstractKey:null});a.hash="38e173ab2c3107ebc5b3da9f216fac98";let l=a},658559:function(e,t,n){var i,o,a,l;n.r(t),n.d(t,{default:()=>r});let s={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"DescriptionWithLinksAndMentions_pin",selections:[{alias:null,args:null,concreteType:"TextTag",kind:"LinkedField",name:"descriptionLinks",plural:!0,selections:[i={alias:null,args:null,kind:"ScalarField",name:"length",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"link",storageKey:null},o={alias:null,args:null,kind:"ScalarField",name:"objectId",storageKey:null},a={alias:null,args:null,kind:"ScalarField",name:"offset",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"tagType",storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"TextTag",kind:"LinkedField",name:"userMentionTags",plural:!0,selections:[i,o,a,l],storageKey:null},{args:null,kind:"FragmentSpread",name:"useHyperlinkExperiment_pin"}],type:"Pin",abstractKey:null};s.hash="93be5ba2b479913d0e23e4971f11a9cd";let r=s},767439:function(e,t,n){n.d(t,{Z:()=>a});var i=n(667294);let o="undefined"!=typeof document?document:{},a=()=>{let e=(0,i.useRef)(void 0),t=o.documentElement,{body:n}=o;return t?[()=>{if(!n||!n.style||e.current)return;let i=window.innerWidth-t.clientWidth,o=parseInt(window.getComputedStyle(n).getPropertyValue("padding-right"),10)||0;t.style.position="relative",t.style.overflow="hidden",n.style.position="relative",n.style.overflow="hidden",n.style.paddingRight=`${o+i}px`,e.current=!0},()=>{n&&n.style&&e.current&&(t.style.position="",t.style.overflow="",n.style.position="",n.style.overflow="",n.style.paddingRight="",e.current=!1)}]:[]}},762802:function(e,t,n){n.d(t,{Z:()=>s});var i=n(667294),o=n(765533),a=n(603316);class l extends i.PureComponent{constructor(...e){var t,n,i;super(...e),t="handleKeyDown",n=e=>{let{onClose:t,goToNext:n,goToPrevious:i}=this.props,l=e.keyCode||e.code;!e.ctrlKey&&!e.metaKey&&(["input","select","button","textarea"].includes(((document.activeElement||{}).tagName||"").toLowerCase())||document.activeElement&&document.activeElement.isContentEditable||(l===o.Z.LEFT?(e.preventDefault(),e.stopPropagation(),i&&i(),(0,a.nP)("web_keydown_left")):l===o.Z.RIGHT?(e.preventDefault(),e.stopPropagation(),n&&n(),(0,a.nP)("web_keydown_right")):l===o.Z.ESCAPE&&(e.preventDefault(),e.stopPropagation(),t())))},(t="symbol"==typeof(i=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?i:i+"")in this?Object.defineProperty(this,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):this[t]=n}componentDidMount(){document.addEventListener("keydown",this.handleKeyDown)}componentWillUnmount(){document.removeEventListener("keydown",this.handleKeyDown)}render(){return null}}let s=l},736802:function(e,t,n){n.d(t,{Z:()=>l});var i=n(20256),o=n(785893);let a=/^(?!.*#.*#)#[\p{L}\p{N}_]\S*$/gu;function l({closeupWithinMasonryEnabled:e=!1,peekCloseupEnabled:t=!1,mWebCloseupRedesignEnabled:n=!1,text:l}){let s=t||n?"200":"300";return l.split(new RegExp(/(#\S*)/)).map((t,n)=>{let l=`${n}-${t}`;return t.match(a)?(0,o.jsx)(i.xv,{color:"link",inline:!0,size:s,children:(0,o.jsx)(i.rU,{display:"inline",href:`/search/pins/?q=${encodeURIComponent(t.replace("#",""))}`,underline:"none",children:t})},l):(0,o.jsx)(i.xv,{color:e?"subtle":void 0,inline:!0,size:s,children:t},l)})}},478086:function(e,t,n){n.d(t,{Z:()=>y});var i,o=n(281098),a=n(667294);n(244311);var l=n(20256),s=n(471998),r=n(736802),d=n(980787),c=n(28427),m=n(805205),u=n(601686),p=n(785893);let h=(void 0!==i||(i=n(658559)).hash&&"93be5ba2b479913d0e23e4971f11a9cd"!==i.hash&&console.error("The definition of 'DescriptionWithLinksAndMentions_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),i),g=e=>null!=e&&e>-1,_=({color:e,mention:t,tagObjectId:n,tagType:i,textSize:o})=>{let{logContextEvent:a}=(0,d.u)();return(0,p.jsx)(l.rU,{display:"inlineBlock",href:`/${t.substr(1)}`,onClick:({event:e})=>{e.stopPropagation(),a({event_type:101,element:11915,aux_data:{tag_id:n,tag_type:i}})},underline:"none",children:(0,p.jsx)(l.xv,{color:e,inline:!0,overflow:"normal",size:o,weight:"bold",children:t},t)},n)},f=({color:e,link:t,tagObjectId:n,tagType:i,text:o,textSize:a})=>{let{logContextEvent:s}=(0,d.u)(),r=(0,m.Z)({site:"www"}),c=t.startsWith("pinterest://")?t.replace("pinterest://",`${r}/`):t;return(0,p.jsx)(l.xv,{color:e,inline:!0,overflow:"normal",size:a,children:(0,p.jsx)(l.rU,{display:"inlineBlock",href:c,onClick:({event:e})=>{e.stopPropagation(),s({event_type:101,element:18123,aux_data:{tag_id:n,tag_type:i,url:t}})},underline:"hover",children:o},n)},o)},y=({description:e,mentionLinkColor:t,pinKey:n,shouldAdjustOffset:i,shouldMakeHashtagLinksFromText:l,textSize:d,descriptionLinks:m,userMentionTags:y})=>{(0,a.useEffect)(()=>{(0,o.Z)("DescriptionWithLinksAndMentions","/app/common/react/components/do/rich-pins/DescriptionWithLinksAndMentions/DescriptionWithLinksAndMentions.tsx")},[]);let{closeupWithinMasonryEnabled:x,peekCloseupEnabled:v}=(0,u.x4)(),b=(0,c.Z)(h,n),{hyperlinkKeywordsEnabled:C}=(0,s.Z)(b),j=y?.length?y.map(e=>({...b?.userMentionTags?.find(t=>t.offset===e.originalOffset),...e})):b?.userMentionTags??[],k=m?.length?m.map(e=>({...b?.descriptionLinks?.find(t=>t.offset===e.originalOffset),...e})):b?.descriptionLinks??[],w=j.length>0,P=C&&k.length>0;if(!w&&!P)return(0,p.jsx)(a.Fragment,{children:e});let T=0,I=[];return[...j.map(t=>({...t,type:"mention",offset:i?((e,t)=>{let n=t.substr(0,e);return(e??0)-(n.length-n.replace(/\s+/g," ").length)})(t.offset??0,e):t.offset??0})),...C?k.map(e=>({...e,type:"link",offset:e.offset??0})):[]].filter(e=>g(e.offset)&&g(e.length)).sort((e,t)=>(e.offset??0)-(t.offset??0)).forEach(n=>{let i=n?.offset??0,o=n?.length??0,a=e.substr(T,i-T),l=e.substr(i,o);I.push(a),n?.type==="mention"?I.push((0,p.jsx)(_,{color:t,mention:l,tagObjectId:n.objectId,tagType:n.tagType,textSize:d})):n?.type==="link"&&n?.link&&I.push((0,p.jsx)(f,{color:t,link:n.link,tagObjectId:n.objectId,tagType:n.tagType,text:l,textSize:d})),T=i+o}),I.push(e.substr(T)),(l?I.flatMap(e=>"string"!=typeof e?e:(0,r.Z)({closeupWithinMasonryEnabled:x,peekCloseupEnabled:v,text:e})):I).reduce((e,t)=>(0,p.jsxs)(a.Fragment,{children:[e,t]}),null)}},406196:function(e,t,n){n.d(t,{E:()=>r,N:()=>d});var i=n(667294),o=n(655202),a=n(729434),l=n(785893);let{Provider:s,get:r}=(0,a.Z)("Flag"),d=({children:e})=>{let[t,n]=(0,i.useState)(),[a,r]=(0,i.useState)(o.Zw.REPORT),[d,c]=(0,i.useState)(o.qb.STARTED),[m,u]=(0,i.useState)(),[p,h]=(0,i.useState)(),g=(0,i.useMemo)(()=>({flagReason:p,flow:a,status:d,selectedReason:m,modalTitle:t,setFlagReason:h,setFlow:r,setModalTitle:n,setStatus:c,setSelectedReason:u}),[t,a,d,m,p]);return(0,l.jsx)(s,{value:g,children:e})}},655202:function(e,t,n){n.d(t,{Vm:()=>a,Zw:()=>i,qb:()=>o});let i={REPORT:"REPORT",BLOCK:"BLOCK",END:"END"},o={STARTED:"STARTED",SELECTED:"SELECTED",SUBMITTED:"SUBMITTED",PROCESSING:"PROCESSING",COMPLETED:"COMPLETED"},a={CONVERSATION:"CONVERSATION",DID_IT:"DID_IT"}},47944:function(e,t,n){n.d(t,{Z:()=>d});var i=n(281098),o=n(667294),a=n(20256),l=n(744862),s=n(19585),r=n(785893);let d=({isQuestion:e,name:t,size:n,src:d})=>{(0,o.useEffect)(()=>{(0,i.Z)("CommentAvatar","/app/packages/comment/CommentAvatar.tsx")},[]);let c=(0,s.ZP)();return(0,r.jsxs)(a.xu,{"data-test-id":"comment-avatar-container",position:"relative",children:[(0,r.jsx)(l.qE,{name:t,size:n,src:d}),e&&(0,r.jsxs)(a.xu,{alignItems:"center",bottom:!0,display:"flex",height:16,justifyContent:"center",marginBottom:-1,marginEnd:-1,position:"absolute",right:!0,width:16,children:[(0,r.jsx)(a.xu,{position:"absolute",children:(0,r.jsx)(a.JO,{accessibilityLabel:c._('Q and A comment', 'comment.userAvatar.creator.q&aIndicator', 'question mark icon indicator background that comment is Q&A'),color:"dark",icon:"speech"})}),(0,r.jsx)(a.xu,{position:"absolute",children:(0,r.jsx)(a.JO,{accessibilityLabel:c._('Q and A comment', 'comment.userAvatar.creator.q&aIndicator', 'question mark icon indicator background that comment is Q&A'),color:"light",icon:"question-mark",size:8})})]})]})}},315787:function(e,t,n){n.d(t,{Z:()=>er});var i=n(281098),o=n(667294),a=n(20256),l=n(581722),s=n(209377),r=n(767439),d=n(111923),c=n(406196),m=n(47944),u=n(296691),p=n(333651),h=n(773655),g=n(744862),_=n(785893);let f={helpfulStyle:{backgroundImage:`url(${p})`},lovedStyle:{backgroundImage:`url(${h})`}},y=({response:e,handleReactionListHover:t,maybeDismissReactionListWithDelay:n})=>{(0,o.useEffect)(()=>{(0,i.Z)("ReactionUser","/app/packages/comment/ReactionUser.tsx")},[]);let l=14===e.reaction_type,s=1===e.reaction_type,r=e.user.is_private_profile?e.user.first_name:e.user.full_name;return(0,_.jsxs)(a.kC,{alignItems:"center",children:[(0,_.jsx)(a.Tg,{href:`/${e.user.username}/`,onBlur:n,onFocus:t,children:(0,_.jsxs)(a.kC,{alignItems:"center",children:[(0,_.jsx)(a.xu,{maxWidth:40,children:(0,_.jsx)(g.qE,{accessibilityLabel:"",name:r,outline:!0,size:"sm",src:e.user.image_medium_url})}),(0,_.jsx)(a.xu,{marginStart:2,maxWidth:80,children:(0,_.jsx)(a.xv,{size:"100",weight:"bold",children:r})})]})}),(0,_.jsxs)(a.xu,{alignContent:"end",display:"flex",padding:2,children:[s&&(0,_.jsx)(a.xu,{dangerouslySetInlineStyle:{__style:f.lovedStyle},"data-test-id":"comment-reaction-tray-loved-emoji",height:16,width:16}),l&&(0,_.jsx)(a.xu,{dangerouslySetInlineStyle:{__style:f.helpfulStyle},"data-test-id":"comment-reaction-tray-helpful-emoji",height:16,width:16})]})]})};var x=n(821342),v=n(886981),b=n(448505),C=n(7872);let j=["userreaction.id","userreaction.reaction_type","userreaction.user()","user.first_name","user.full_name","user.id","user.image_medium_url","user.is_private_profile","user.username"],k=({commentId:e,handleReactionListHover:t,isMarkedHelpfulByMe:n,isLovedByMe:l,isTry:s,maybeDismissReactionListWithDelay:r})=>{(0,o.useEffect)(()=>{(0,i.Z)("ReactionList","/app/packages/comment/ReactionList.tsx")},[]);let d=(0,x.Z)(),c=(0,b.Z)(),m=(0,v.Z)({name:"ApiResource",options:{url:s?`/v3/did_it/${e}/reacted_by/`:`/v3/aggregated_comments/${e}/reacted_by/`,field_sets:j}}),u=(0,C.lJ)(d,c)||("id"in d&&d.id?d.id:""),p=m.data;(l||n)&&p&&(p=p.filter(e=>e.user.id!==u),p=[{id:e,reaction_type:l?1:14,user:{first_name:(0,C.Fk)(d,c),full_name:(0,C.Fk)(d,c),id:u,image_medium_url:(0,C.gJ)(d,c),is_private_profile:!!d.isAuth&&!!d.isPrivateProfile,username:(0,C.Ms)(d,c)}},...p]);let h=(0,o.useRef)(null);return(0,o.useEffect)(()=>{let{current:e}=h,t=()=>{m.isFetching||(m.isAtEnd?e?.removeEventListener("scroll",t):m.fetchMore())};return e?.addEventListener("scroll",t),()=>{e?.removeEventListener("scroll",t)}},[m]),(0,_.jsx)(a.xu,{ref:h,maxHeight:140,overflow:"auto",rounding:2,width:200,children:p?.map(e=>(0,_.jsx)(a.xu,{"data-test-id":"reaction-list-single-user",margin:3,children:(0,_.jsx)(y,{handleReactionListHover:t,maybeDismissReactionListWithDelay:r,response:e})},e.id))})};var w=n(19585),P=n(302148),T=n(821806),I=n(601686);let A=(0,o.lazy)(()=>n.e("46308").then(n.bind(n,766289))),S="comment-reaction-container-entry-point",L=({commentId:e,dismissReactionList:t,helpfulCount:n,isDesktop:l,isMarkedHelpfulByMe:s,isLovedByMe:r,isReactionListOpen:d,isTry:c,lovedCount:m,onReactionCountHover:g,onToggleHelpful:f,onToggleLove:y})=>{(0,o.useEffect)(()=>{(0,i.Z)("CommentReactionContainer","/app/packages/comment/CommentReactionContainer.tsx")},[]);let x=(0,w.ZP)(),{isCommentComposerFocused:v}=(0,I.x4)(),b=(0,o.useRef)(null),C=l?16:12,[j,L]=(0,o.useState)(!1),E=!1,z=(m||0)+(n||0);s&&r&&(z-=1);let R=e=>()=>{L(e)},D=()=>{E=!0,g()},Z=()=>{E=!1,setTimeout(()=>{E||t()},1e3)},M=l?(0,_.jsx)(a.xu,{"data-test-id":S,children:j?(0,_.jsx)(a.iP,{onMouseLeave:R(!1),onTap:R(!1),children:(0,_.jsx)(T.Z,{children:(0,_.jsx)(A,{onTooltipHover:R(!1),setHelpful:f(!0),setLoved:y(!0)})})}):(0,_.jsx)(a.iP,{onMouseEnter:R(!0),onTap:R(!0),children:(0,_.jsx)(a.JO,{accessibilityLabel:x._('React', 'comment.actionbar.react', 'accessibility label entry point to react to a comment'),color:"subtle",icon:"heart-outline",size:C})})}):(0,_.jsx)(a.xu,{"data-test-id":S,margin:-1.5,children:(0,_.jsx)(a.hU,{accessibilityLabel:x._('React', 'comment.actionbar.react', 'accessibility label entry point to react to a comment'),icon:"heart-outline",onClick:y(!0),size:"xs"})});return(0,_.jsxs)(a.kC,{alignItems:"center",gap:{row:l?1:1.5,column:0},children:[s||r?(0,_.jsx)(a.iP,{onTap:()=>{f(!1)(),y(!1)()},children:(0,_.jsx)(a.xu,{dangerouslySetInlineStyle:{__style:{backgroundImage:`url(${r?h:p})`,backgroundSize:"contain"}},"data-test-id":r?"comment-reaction-container-loved-emoji":"comment-reaction-container-helpful-emoji",height:C,width:C})}):M,z>0&&(0,_.jsxs)(o.Fragment,{children:[(0,_.jsx)(a.iP,{accessibilityLabel:(0,P.Wc)(x.ngettext('{{reactionCount}} Reaction', '{{reactionCount}} Reactions', z, 'Comment.CommentReactionContainer.ariaLabel', 'accessibility label for the number of reactions to a comment. reactionCount: number of reactions'),{reactionCount:z.toString()}),onMouseEnter:D,onMouseLeave:Z,onTap:D,children:(0,_.jsx)(a.xu,{ref:b,"data-test-id":"comment-reaction-container-reaction-count",display:l?void 0:"flex",children:(0,_.jsx)(a.xv,{color:l?"subtle":"default",inline:!0,size:l?"200":"100",weight:"bold",children:z})})}),d&&(0,_.jsx)(a.mh,{zIndex:u.Ty,children:(0,_.jsx)(a.J2,{anchor:b.current,idealDirection:"down",onDismiss:t,positionRelativeToAnchor:!1,shouldFocus:!v,children:(0,_.jsx)(a.iP,{onMouseEnter:D,onMouseLeave:Z,children:(0,_.jsx)(k,{commentId:e,handleReactionListHover:D,isLovedByMe:r,isMarkedHelpfulByMe:s,isTry:c,maybeDismissReactionListWithDelay:Z})})})})]})]})};var E=n(624895),z=n(54424),R=n(545961),D=n(162321);function Z(e){(0,o.useEffect)(()=>{(0,i.Z)("PhotoCommentContent","/app/packages/comment/PhotoCommentContent.tsx")},[]);let{comment:t,commentTags:n,handlePhotoTap:l,isDesktop:s,previewPhoto:r,taggedUsers:d}=e,[c,m]=(0,o.useState)(!1),{user:{username:u}}=t,p="text"in t?t.text:t.details,h=s?`${u} ${p}`:p,{height:g,url:f,width:y}=r||{},x=g??R.Vb,v=y??R.mu;return(0,_.jsxs)(a.xu,{children:[(0,_.jsx)(D.Z,{isFirstTaggedUserAuthor:!0,shouldShowFirstNameOnly:!0,taggedUsers:d,tags:n,text:h}),s||!s?(0,_.jsx)(a.xu,{marginBottom:s?void 0:1.5,marginTop:s?1:.5,children:(0,_.jsx)(R.ZP,{canEnlargePhoto:s,isSelectedPhoto:!1,previewPhoto:r})}):(0,_.jsx)(a.xu,{height:150,marginBottom:s?4:2,marginTop:1,width:150,children:(0,_.jsx)(a.iP,{disabled:!s,onMouseEnter:()=>m(!0),onMouseLeave:()=>m(!1),onTap:l,children:(0,_.jsx)(a.zd,{rounding:2,wash:!0,children:f&&(0,_.jsx)(a.Ee,{alt:f,color:"#efefef",naturalHeight:x,naturalWidth:v,src:f,children:(0,_.jsx)(a.xu,{dangerouslySetInlineStyle:{__style:{cursor:s?"zoom-in":void 0,backgroundColor:`rgba(17, 17, 17, ${.4*!!c})`}},height:"100%",width:"100%"})},f)})})})]})}var M=n(667835),O=n(105433),F=n(696323);function N(e){(0,o.useEffect)(()=>{(0,i.Z)("ReplyThread","/app/packages/comment/ReplyThread.tsx")},[]);let{featuredCommentId:t,parentId:n,parentType:s,inCommentsImprovedDropdownExp:r,inCommentsPopover:d,isDesktop:c,isLoading:m,isReadOnly:u,openOverflowMenu:p,replyingToCommentId:h,toggleEditComposer:g,toggleHelpful:f,toggleLike:y,toggleReplyComposer:x,isORBACProfileManager:v,isVideo:b,storyPinDataId:C,pinId:j,closeupAttributionId:k,aggregatedPinDataId:T,closeupAttributionUsername:I,pinnerId:A,reactionListCommentId:S,showReactionListForComment:L,viewParameter:E}=e,z=(0,w.ZP)(),R=(0,M.vs)(),D=(0,O.lV)(),Z=(0,l.v9)(({feeds:e})=>{let t=e[`${F.Z.AGGREGATED_COMMENT_REPLIES}:${n}`]||[],i=e[`${F.Z.AGGREGATED_COMMENTS}:${n}`]||[];return t.concat(i).reduceRight((e,{id:t})=>{let n=D[t];return n?[...e,n]:e},[])}),N=(0,o.useRef)(!0),H=(0,o.useRef)(Z.length),[U,K]=(0,o.useState)(1),[W,B]=(0,o.useState)(!1),G=U===Z.length;return(0,o.useEffect)(()=>{let e=H.current,t=Z.length;N.current?t>0&&(N.current=!1):t>e&&B(!0),t!==e&&K(e=>e>1?t:+(t>0)),H.current=t},[Z.length]),(0,_.jsxs)(o.Fragment,{children:[Z.length>1&&(0,_.jsx)(a.iP,{onTap:()=>{K(G?0:Z.length)},children:(0,_.jsxs)(a.xu,{alignItems:c?void 0:"center",display:c?void 0:"flex",marginBottom:c?4:6,children:[c?(0,_.jsx)(a.xu,{display:"inlineBlock",marginEnd:2,children:(0,_.jsx)(a.xv,{color:"subtle",size:"200",weight:"bold",children:"⎯⎯"})}):(0,_.jsx)(a.xu,{dangerouslySetInlineStyle:{__style:{background:R?"white":"black"}},height:1,marginEnd:2,width:32}),(0,_.jsx)(a.xv,{color:c?"subtle":"default",inline:!0,size:"100",weight:"bold",children:G?z._('Hide replies', 'comment.button.hideReplies', 'hide comment replies'):(0,P.nk)(z.ngettext('View {{ commentCount }} reply', 'View {{ commentCount }} replies', Z.length, 'comment.button.showReplies', 'show comment replies'),{commentCount:Z.length})})]})}),(0,_.jsx)(er,{aggregatedPinDataId:T,closeupAttributionId:k,closeupAttributionUsername:I,comments:(()=>{if(0===U||0===Z.length)return[];if(1===U)if(W)return Z.slice(-1);else return Z.slice(0,1);return Z.slice(0,U)})(),commentsDisabled:!1,featuredCommentId:t,gapSize:c?2:6,inCommentsImprovedDropdownExp:r,inCommentsPopover:d,isDesktop:c,isLoading:m,isORBACProfileManager:v,isReadOnly:u,isVideo:b,openOverflowMenu:p,parentId:n,parentType:s,pinId:j,pinnerId:A,reactionListCommentId:S,replyingToCommentId:h,showReactionListForComment:L,storyPinDataId:C,toggleEditComposer:g,toggleHelpful:f,toggleLike:y,toggleReplyComposer:x,userAvatarSize:"sm",viewParameter:E})]})}var H=n(980787),U=n(657043),K=n(475498),W=n(670622),B=n(2420),G=n(15667),$=n(536652),V=n(87853),q=n(542092),J=n(636921),Q=n(502066),X=n(483190),Y=n(611134),ee=n(401450),et=n(78762);let en=(0,o.lazy)(()=>n.e("16592").then(n.bind(n,357966))),ei=(0,et.Z)(()=>n.e("73842").then(n.bind(n,434780)),void 0,e=>434780,"app-packages-comment-CommentOverflowPopover",e=>["73842"]),eo=(0,o.lazy)(()=>n.e("84046").then(n.bind(n,257233)));function ea(e){let t,n;(0,o.useEffect)(()=>{(0,i.Z)("Comment","/app/packages/comment/Comment.tsx")},[]);let{aggregatedPinDataId:p,closeupAttributionId:h,closeupAttributionUsername:g,comment:f,featuredCommentId:y,inCommentsImprovedDropdownExp:v,inCommentsPopover:j,isDesktop:k,isReadOnly:A,isVideo:S,openOverflowMenu:R,toggleReplyComposer:F,parentId:et,parentType:ea=q.o.pin,pinId:el,storyPinDataId:es,replyingToCommentId:er,showReactionListForComment:ed,showTopCommentHeading:ec,toggleEditComposer:em,toggleHelpful:eu,toggleLike:ep,userAvatarSize:eh,isORBACProfileManager:eg,pinnerId:e_,reactionListCommentId:ef,viewParameter:ey}=e,{user:{id:ex,first_name:ev,id:eb,image_medium_url:eC,username:ej},id:ek,is_translatable:ew,comment_count:eP,helpful_count:eT,tags:eI=[]}=f,[eA,eS]=(0,o.useState)(!1),eL=eA&&f.translatedText||f.text,eE=!ew||""===f.translatedText,ez=(0,J.Z)(),eR=!1,eD=0,eZ=!1,eM=!!f.marked_helpful_by_me,eO=k?[f.user]:[],eF="",eN=new Date;"aggregatedcomment"===f.type?(eR=f.highlighted_by_pin_owner,eD=f.reaction_counts[1],eZ=f.reaction_by_me>0,n=f?.media?.sticker,eO.push(...f.tagged_users),eF=k?`${ej} ${eL??""}`:eL??"",eN=new Date(f.created_at)):(eD=f.like_count,eZ=f.liked_by_me,t=f.images[0]||{},eF=k?`${ej} ${f.details}`:f.details,eN=new Date(f.done_at));let eH=t?.originals,eU=n||eH,eK=(0,w.ZP)(),eW=(0,x.Z)(),{setIsMediaViewerOpen:eB,clientTrackingParams:eG,setIsCommentPopoverInteractionActive:e$}=(0,I.x4)(),{logContextEvent:eV}=(0,H.u)(),{isBot:eq}=(0,G.B)(),{showToast:eJ}=(0,V.dI)(),eQ=(0,l.I0)(),eX=(0,M.vs)(),eY=(0,o.useRef)(null),{hasApplicableLawForCountry:e0}=(0,X.ZP)(),e1=!A||e0,e2="aggregatedcomment"===f.type&&1===f.comment_tag,e6=e2&&k,e3=(0,b.Z)(),e4=(0,C.lJ)(eW,e3),{nativeEngagementsHiddenForUser:e7}=(0,Q.G)(),{aggregatedCommentsHiddenForUser:e8,translateAggregatedComment:e9,updateAggregatedComment:e5}=(0,O.nf)(),te=(0,d.Z)(),tt="userdiditdata"===f.type,tn=(0,W.Z)(),ti=ew&&!1,to=`comment-overflow-popover-${ek}`,ta=(0,u.zs)(ej,eI,eX,!k),tl={SHOW_TRANSLATION:eK._('Show translation', 'comment.translateButton.showTranslation', 'text for translation button when translation is available'),TRANSLATING:eK._('Translating...', 'comment.translateButton.translating', 'text for translation button while translating'),SHOW_ORIGINAL:eK._('Show original', 'comment.translateButton.showOriginal', 'text for translation button after translating')},ts=(0,o.useRef)(tl.SHOW_TRANSLATION),[tr,td]=(0,r.Z)(),[tc,tm]=(0,o.useState)(!1),[tu,tp]=(0,o.useState)(!1),[th,tg]=(0,o.useState)(!1),[t_,tf]=(0,o.useState)(!1),[ty,tx]=(0,o.useState)(!1),[tv,tb]=(0,o.useState)(!1),[tC,tj]=(0,o.useState)(!1),[tk,tw]=(0,o.useState)(u.A9.NONE),tP=e=>()=>{em?em(f):tp(e)};(0,o.useEffect)(()=>{ti&&eV({event_type:10416,view_type:3,view_parameter:ey,component:"pin"===ea?13696:13697})},[eV,ea,ti,ey]),(0,o.useEffect)(()=>{eP>0&&!eq&&eQ((0,$.U)("aggregatedcomment"===f.type?"AggregatedCommentReplyFeedResource":"DidItCommentsResource",{options:{isUnifiedComment:!0,objectId:ek,redux_normalize_feed:!0}}))},[f.type,ek]);let tT=ea.toLowerCase()===q.o.aggregatedComment.toLowerCase()||ea.toLowerCase()===q.n.didIt.toLowerCase(),tI=f.user.first_name||"",tA=async({contentMarkdown:e,force:t,tags:n})=>{let i,o;tf(!0);let a=f.id;if(tT&&(i=ea.toLowerCase()===q.n.didIt,a=et,o=f.id),a)try{await te({force:t,fromUnifiedComment:!0,objectType:tt||i?q.o.didIt:q.o.aggregatedComment,objectId:a,orbacSubjectId:e4,tags:n,text:e,replyToCommentId:o})}catch(t){let e=(0,U.Z)(t,"code");if([B.ky,B.LJ].includes(e??0)&&k)return tw(e===B.ky?u.A9.WARNING:u.A9.BLOCK),tf(!1),!1}return F&&F(void 0),tf(!1),!0},tS=async({contentMarkdown:e,force:t,tags:n})=>{tg(!0);try{tt?await eQ((0,Y.IU)({id:f.id,details:e,pinId:el??"",image_signatures:"image_signatures"in f&&f.image_signatures?f.image_signatures:[]})):await e5({commentId:f.id,force:t,orbacSubjectId:e4,tags:n,text:e})}catch(e){if([B.ky,B.LJ].includes((0,U.Z)(e,"code")??0)&&k)return tw(e.code===B.ky?u.A9.WARNING:u.A9.BLOCK),tg(!1),!1}return tp(!1),tg(!1),!0},tL=()=>{k?(e$(!tc),tm(!tc)):R&&R(f)},tE=e=>()=>{e$(e),tm(e),tj(e),e||eV({component:14349,event_type:9408})},tz=()=>{tw(u.A9.NONE)},tR=e=>{e?td():tr(),eB(!e),tx(!e)};(0,o.useEffect)(()=>{eA&&eE&&(eS(!eA),eJ(({hideToast:e})=>(0,_.jsx)(K.Z,{onHide:e,text:eK._('Error - couldn\'t translate', 'comment.couldNotTranslate.toast', 'error toast that shows after unsuccessful translation'),type:"error"})))},[eA,eE]),eA?ts.current=f.translatedText?tl.SHOW_ORIGINAL:tl.TRANSLATING:ts.current=tl.SHOW_TRANSLATION;let tD=k?128:110,tZ="aggregatedcomment"===f.type&&f.media?.sticker?.image_url&&(0,_.jsx)(a.xu,{height:tD,marginBottom:+!!k,marginTop:1,width:tD,children:f.media?.sticker?.image_url&&(0,_.jsx)(a.Ee,{alt:f.media?.sticker?.display_name??"",fit:"contain",naturalHeight:0,naturalWidth:0,src:f.media.sticker.image_url})});return(0,_.jsxs)(o.Fragment,{children:[(0,_.jsx)(a.xH,{accessibilityLabel:"Loading comment",show:th}),!tu&&!th&&(0,_.jsxs)(a.kC,{alignItems:"stretch",justifyContent:"start",children:[(0,_.jsx)(a.xu,{marginEnd:2,children:(0,_.jsx)(s.rU,{to:`/${ej}/`,children:(0,_.jsx)(m.Z,{isQuestion:e6,name:ev||ej||"",size:eh,src:eC??""})})}),(0,_.jsxs)(a.kC,{direction:"column",flex:"grow",justifyContent:"start",children:[(0,_.jsxs)(a.kC,{justifyContent:"between",children:[(0,_.jsx)(a.kC.Item,{minWidth:0,children:(0,_.jsxs)(a.kC,{dataTestId:"author-and-comment-container",direction:"column",children:[!k&&(0,_.jsxs)(a.kC,{alignItems:"center",gap:{row:1,column:0},children:[(0,_.jsx)(D.Z,{isFirstTaggedUserAuthor:!0,lineHeight:"14px",marginEnd:0,shouldShowFirstNameOnly:!0,size:"100",taggedUsers:[f.user],tags:(0,u.zs)(ej,[],eX),text:ej}),e2&&!ec&&(0,_.jsx)(a.xu,{dangerouslySetInlineStyle:{__style:{lineHeight:"14px"}},children:(0,_.jsx)(a.xv,{color:"subtle",size:"100",children:eK._('asked a question \uD83D\uDC40', 'comment.question.label', 'label on a comment that is a question')})}),ec&&(0,_.jsxs)(a.kC,{children:[(0,_.jsx)(a.xu,{alignItems:"center",display:"flex",marginEnd:1,children:(0,_.jsx)(a.JO,{accessibilityLabel:(0,u.yW)(eK),color:"recommendation",icon:"star",size:12})}),(0,_.jsx)(a.xv,{color:"recommendation",size:"100",weight:"bold",children:(0,u._q)(eK)})]}),(e2||ec)&&eN&&(0,_.jsx)(a.xv,{color:"subtle",size:"100",children:"·"}),eN&&(0,_.jsx)(a.xu,{"data-test-id":"comments-time-passed",children:(0,_.jsx)(a.xv,{color:"subtle",size:"100",children:tn(eN,!0)})})]}),tt?(0,_.jsx)(Z,{comment:f,commentTags:ta,handlePhotoTap:()=>tR(ty),isDesktop:k,previewPhoto:eH,taggedUsers:eO}):(0,_.jsx)(D.Z,{isFirstTaggedUserAuthor:!!k,lineHeight:k?void 0:"21px",marginBottom:k?void 0:"4px",shouldShowFirstNameOnly:!0,taggedUsers:eO,tags:ta,text:eF}),tZ,ti&&(0,_.jsx)(a.xu,{marginBottom:2,marginTop:2,children:(0,_.jsx)(a.iP,{onTap:()=>void(!eA&&!f.translatedText&&e9(f.id),eA||ts.current!==tl.SHOW_TRANSLATION?eA&&ts.current===tl.SHOW_ORIGINAL&&eV({event_type:10418,view_type:3,view_parameter:ey,component:"pin"===ea?13696:13697}):eV({event_type:10417,view_type:3,view_parameter:ey,component:"pin"===ea?13696:13697}),eS(!eA)),children:(0,_.jsx)(a.xv,{color:"subtle",size:"300",weight:"bold",children:ts.current})})})]})}),y===ek&&(0,_.jsx)(a.xu,{alignSelf:"center",color:"primary",height:8,minWidth:8,rounding:"pill"})]}),eR&&(0,_.jsx)(a.xu,{marginBottom:k?3:1.5,marginTop:k?4:-.5,children:(0,_.jsx)(a.xv,{size:"100",children:(0,P.nk)(eK._('Highlighted by @{{ closeupAttributionUsername }}', 'comment.highlighted.label', 'label on comment that has been highlighted by the Pin creator'),{closeupAttributionUsername:g})})}),e1&&(0,_.jsx)(a.xu,{alignItems:"center",display:"flex",height:k?25:"100%",justifyContent:"between",position:"relative",children:(0,_.jsxs)(a.kC,{alignItems:"center",gap:{row:k?5:4,column:0},children:[!A&&k&&(0,_.jsx)(a.xu,{"data-test-id":"comments-time-passed",children:(0,_.jsx)(a.xv,{color:"subtle",size:"200",children:tn(eN,!0)})}),!A&&(0,_.jsx)(a.xu,{"data-test-id":"comment-reply-button-container",children:(0,_.jsx)(a.iP,{onTap:()=>{F&&F(f,et,ea)},children:(0,_.jsx)(a.xv,{color:k?"subtle":"default",size:k?"200":"100",weight:"bold",children:eK._('Reply', 'comment.button.reply', 'entry point to reply to comment')})})}),!A&&(0,_.jsx)(L,{commentId:ek,dismissReactionList:()=>{ed(void 0)},helpfulCount:eT,isDesktop:k,isLovedByMe:eZ,isMarkedHelpfulByMe:eM,isReactionListOpen:ef===ek,isTry:tt,lovedCount:eD,onReactionCountHover:()=>{ed(ek),eV({event_type:9906,component:"pin"===ea?13696:13697,view_type:3,view_parameter:ey})},onToggleHelpful:e=>()=>{eM!==e&&eu(ek,!e,tt)()},onToggleLove:e=>()=>{eZ!==e&&ep(ek,!e,tt)()}}),!("id"in eW&&eW.id===eb&&e2)&&(k?(0,_.jsx)(a.xu,{ref:eY,"data-test-id":"comment-more-options",children:(0,_.jsx)(a.hU,{accessibilityControls:to,accessibilityExpanded:tc,accessibilityHaspopup:!0,accessibilityLabel:eK._('More', 'comment.button.more', 'see more options for comment'),icon:"ellipsis",iconColor:"gray",onClick:tL,size:"xs"})}):(0,_.jsx)(a.xu,{"data-test-id":"comment-more-options",children:(0,_.jsx)(a.iP,{accessibilityControls:to,accessibilityExpanded:tc,accessibilityHaspopup:!0,onTap:tL,children:(0,_.jsx)(a.JO,{accessibilityLabel:eK._('More', 'comment.button.more', 'see more options for comment'),color:eX?"light":"dark",icon:"ellipsis",size:12})})}))]})})]})]}),k&&(0,_.jsxs)(o.Fragment,{children:[tu&&!(j||v)&&(0,_.jsx)(a.xu,{marginTop:3,children:(0,_.jsx)(E.Z,{clientTrackingParams:eG,commentWarningModalState:tk,dismissCommentWarningModal:tz,initialTags:f.tags,initialText:"aggregatedcomment"===f.type?f.text:f.details,isEditing:!0,objectType:q.o.aggregatedComment,onAddItem:tS,onCancelItem:tP(!1),postedPhoto:eU,showCommentComposer:!0,statusType:"textInFlightNested",viewParameter:ey})}),er===ek&&(0,_.jsx)(a.xu,{marginStart:12*!tT,marginTop:3,children:(0,_.jsx)(E.Z,{commentWarningModalState:tk,dismissCommentWarningModal:tz,initialTags:tT?[{offset:0,object_id:ex,length:tI.length,tag_type:1}]:[],initialText:tT?`${tI} `:"",isReplying:!0,objectType:q.o.aggregatedComment,onAddItem:tA,onCancelItem:()=>{F&&F()},showCommentComposer:!0,statusType:"textInFlightNested",viewParameter:ey})})]}),(eP>0||t_)&&(0,_.jsx)(a.xu,{marginStart:k?12:10,marginTop:k?4:3,children:(0,_.jsx)(N,{aggregatedPinDataId:p,closeupAttributionId:h,closeupAttributionUsername:g,featuredCommentId:y,inCommentsImprovedDropdownExp:v,inCommentsPopover:j,isDesktop:k,isLoading:t_,isORBACProfileManager:eg,isReadOnly:A,isVideo:S,openOverflowMenu:R,parentId:ek,parentType:f.type,pinId:el,pinnerId:e_,reactionListCommentId:ef,replyingToCommentId:er,showReactionListForComment:ed,storyPinDataId:es,toggleEditComposer:em,toggleHelpful:eu,toggleLike:ep,toggleReplyComposer:F,viewParameter:ey})}),k&&e1&&(0,_.jsx)(ei,{aggregatedPinDataId:p,anchor:eY.current,closeupAttributionId:h,comment:f,dismiss:e=>{tm(!1),e||(e$(!1),eV({component:14349,event_type:10128}))},id:to,inCommentsPopover:!!j,isOpen:tc,isReply:tT,onEdit:tP(!0),onShowBlockUserModal:tE(!0),parentId:et,pinId:el}),tv&&(0,_.jsx)(T.Z,{children:(0,_.jsx)(c.N,{children:(0,_.jsx)(eo,{aggregatedPinDataId:p,didItDataId:ek,onClose:e=>()=>{tb(!e)},pinId:el??"",username:ej,users:[f.user]})})}),tC&&(0,_.jsx)(T.Z,{children:(0,_.jsx)(en,{firstName:ev??"",onBlockUser:()=>{eQ((0,ee.Ge)({id:ex,orbacSubjectId:e4,blockSource:"comment",blockContext:ek,logContextEvent:eV})),e8(ex),e7(ex),eV({event_type:101,component:13712,element:87,view_type:220,aux_data:{creator_id:eW.isAuth?eW.id:null}}),eV({component:14349,event_type:9407}),tj(!1),ez(),e$(!1)},onClearModal:tE(!1)})}),!!eH&&ty&&(0,_.jsx)(z.Z,{onDismiss:()=>tR(ty),photo:eH})]})}var el=n(351607),es=n(883379);function er(e){let t,n;(0,o.useEffect)(()=>{(0,i.Z)("CommentThread","/app/packages/comment/CommentThread.tsx")},[]);let{aggregatedPinDataId:l,comments:s,commentsDisabled:r,commentsScrollContainerRef:d,featuredCommentId:c,gapSize:m=6,id:u,inCommentsImprovedDropdownExp:p,inCommentsPopover:h,isDesktop:g,isLoading:f=!1,isReadOnly:y,openOverflowMenu:x,toggleReplyComposer:v,parentId:b,parentType:C,replyingToCommentId:j,showingCloseupCommentModule:k,toggleEditComposer:P,toggleHelpful:T,toggleLike:A,userAvatarSize:S,isORBACProfileManager:L,isVideo:E,storyPinDataId:z,pinId:R,closeupAttributionId:D,closeupAttributionUsername:Z,pinnerId:M,showReactionListForComment:O,reactionListCommentId:F,viewParameter:N}=e,H=(0,w.ZP)(),{closeupWithinMasonryEnabled:U}=(0,I.x4)(),K=(0,es.Z)({skipExpActivation:!0}),W=!!k&&!1;return(h?t="12px":U&&(t="8px"),n=z?"story":E?"video":"pin",r)?(0,_.jsx)(a.xu,{alignSelf:"center","data-test-id":"comments-disabled-label",marginTop:U?2:void 0,width:"100%",children:(0,_.jsx)(a.xv,{align:g?"start":"center",color:"subtle",children:H._('Comments are turned off for this Pin', 'commentThread.disabledState.message', 'Comments are turned off or disabled for this pin')})}):s.length>0?(0,_.jsxs)(a.xu,{ref:d,dangerouslySetInlineStyle:{__style:{gap:`${4*m}px 0`,overscrollBehavior:h?"none":"auto",scrollbarGutter:U?"stable":void 0,paddingTop:t,overflowX:K?"scroll":void 0}},"data-test-id":"aggregated-comment-list",direction:"column",display:"flex",id:u,maxHeight:U&&!h?722:"100%",overflow:U?"auto":void 0,width:"100%",children:[s.map((e,t)=>(0,_.jsx)(el.Fw,{componentType:"pin"===C?13696:13697,impressionAuxFields:{commentId:e.id,pinId:R,pinOwnerUserId:D,pinType:n,parentId:b,parentType:C,commentType:"aggregatedComment"},impressionType:"Comment",loggingId:e.id,slotIndex:t,viewType:g?3:98,children:({impressionTrackerRef:n})=>{let i=t===s.length-1;return(0,_.jsx)(a.xu,{ref:n,dangerouslySetInlineStyle:{__style:{paddingBottom:h&&i?"24px":"0px"}},"data-test-id":"commentThread-comment",tabIndex:0,children:(0,_.jsx)(ea,{aggregatedPinDataId:l,closeupAttributionId:D,closeupAttributionUsername:Z,comment:e,featuredCommentId:c,inCommentsImprovedDropdownExp:p,inCommentsPopover:h,isDesktop:g,isORBACProfileManager:L,isReadOnly:y,isVideo:E,openOverflowMenu:x,parentId:b,parentType:C,pinId:R,pinnerId:M,reactionListCommentId:F,replyingToCommentId:j,showReactionListForComment:O,showTopCommentHeading:W&&0===t,storyPinDataId:z,toggleEditComposer:P,toggleHelpful:T,toggleLike:A,toggleReplyComposer:v,userAvatarSize:S,viewParameter:N})})}},e.id)),f&&(0,_.jsx)(a.xH,{accessibilityLabel:H._('Comments loading', ' - ', ' -- '),show:f})]}):(0,_.jsx)(a.xu,{alignSelf:"center",width:"100%",children:(0,_.jsx)(a.xH,{accessibilityLabel:H._('Comments loading', ' - ', ' -- '),show:f})})}},624895:function(e,t,n){n.d(t,{Z:()=>r});var i=n(281098),o=n(667294),a=n(782259),l=n(785893);let s=(0,o.lazy)(()=>Promise.all([n.e("8907"),n.e("66979")]).then(n.bind(n,656379)));function r(e){return(0,o.useEffect)(()=>{(0,i.Z)("InlineCommentComposer","/app/packages/comment/InlineCommentComposer.tsx")},[]),(0,l.jsx)(a.Z,{fallback:null,children:(0,l.jsx)(s,{...e})})}},54424:function(e,t,n){n.d(t,{Z:()=>c});var i=n(281098),o=n(667294),a=n(20256),l=n(762802),s=n(678213),r=n(19585),d=n(785893);function c({onDismiss:e,photo:t}){(0,o.useEffect)(()=>{(0,i.Z)("MediaViewer","/app/packages/comment/MediaViewer.tsx")},[]);let n=(0,r.ZP)(),{height:c,url:m,width:u}=t,p=Math.min(c??936,936),h="100vh",g=n._('Close media viewer', 'comments.photo.mediaViewer.close', 'Close media viewer overlay');return(0,d.jsxs)(a.mh,{zIndex:s.b7,children:[(0,d.jsx)(a.iP,{mouseCursor:"zoomOut",onTap:e,children:(0,d.jsxs)(a.xu,{alignItems:"center",bottom:!0,dangerouslySetInlineStyle:{__style:{backgroundColor:"rgba(0, 0, 0, 0.8)"}},"data-test-id":"comment-media-viewer",display:"flex",height:h,justifyContent:"center",left:!0,position:"fixed",right:!0,top:!0,width:"100%",children:[(0,d.jsx)(a.xu,{left:!0,padding:5,position:"absolute",top:!0,children:(0,d.jsx)(a.hU,{accessibilityLabel:g,icon:"cancel",iconColor:"white",onClick:e,padding:3,size:"lg"})}),(0,d.jsx)(a.xu,{dangerouslySetInlineStyle:{__style:{margin:"0 84px"}},height:h,maxHeight:p,width:u,children:m&&(0,d.jsx)(a.Ee,{alt:m??"",fit:"contain",naturalHeight:c??1,naturalWidth:u??1,src:m},m)})]})}),(0,d.jsx)(l.Z,{onClose:e})]})}},545961:function(e,t,n){n.d(t,{Vb:()=>g,ZP:()=>f,mu:()=>_});var i=n(281098),o=n(667294),a=n(20256),l=n(767439),s=n(296691),r=n(436873),d=n(54424),c=n(19585),m=n(15667),u=n(647709),p=n(601686),h=n(785893);let g=150,_=346;function f({canEnlargePhoto:e,containerWidth:t,isSelectedPhoto:n,previewPhoto:f,removeSelectedPhoto:y}){(0,o.useEffect)(()=>{(0,i.Z)("PhotoCommentPreview","/app/packages/comment/PhotoCommentPreview.tsx")},[]);let x=(0,c.ZP)(),v=(0,u.HG)(),{isRTL:b}=(0,m.B)(),{setIsMediaViewerOpen:C}=(0,p.x4)(),[j,k]=(0,l.Z)(),[w,P]=(0,o.useState)(!1),[T,I]=(0,o.useState)(!1),[A,S]=(0,o.useState)(null),[L,E]=(0,o.useState)(s.WU),z=(0,r.Z)(f)?f?.url:f?.image_url;(0,o.useEffect)(()=>{(async()=>{z&&!(0,r.Z)(f)&&S(await new Promise((e,t)=>{let n=new Image;n.onload=()=>{e({width:n.width,height:n.height})},n.onerror=t,n.src=z}))})()},[z,f]);let R=(0,r.Z)(f)?f?.width:A?.width,D=(0,r.Z)(f)?f?.height:A?.height,Z=R??0,M=D??0,O=z??"",F=Math.min((t||(v?_:312))/Z,(v?g:110)/M,1),N=x._('Remove photo', 'photoCommentPreview.removePhoto', 'Icon to remove the selected photo from the comment composer'),H=x._('Photo', 'photoCommentPreview.previewPhoto', 'Photo previewed as part of a comment'),U=e=>{e?k():j(),C(!e),P(!e)};return(0,h.jsxs)(a.xu,{height:F*M,marginTop:3*!!n,position:"relative",width:F*Z,children:[(0,h.jsx)(a.iP,{disabled:!e,onMouseEnter:()=>I(!0),onMouseLeave:()=>I(!1),onTap:()=>U(w),children:(0,h.jsx)(a.zd,{rounding:2,children:O&&(0,h.jsx)(a.Ee,{alt:H,color:L,naturalHeight:M,naturalWidth:Z,onLoad:()=>{E(s.o),n&&URL.revokeObjectURL(O)},src:O,children:e&&(0,h.jsx)(a.xu,{dangerouslySetInlineStyle:{__style:{cursor:"zoom-in",backgroundColor:`rgba(17, 17, 17, ${.4*!!T})`}},height:"100%",width:"100%"})},H)})}),n&&(0,h.jsx)(a.xu,{alignItems:"center",display:"flex",height:24,justifyContent:"center",left:b,marginEnd:-3,marginTop:-3,position:"absolute",right:!b,top:!0,width:24,children:(0,h.jsx)(a.hU,{accessibilityLabel:N,bgColor:"lightGray",icon:"cancel",onClick:y,size:"xs"})}),w&&(0,h.jsx)(d.Z,{onDismiss:()=>U(w),photo:f})]})}},162321:function(e,t,n){n.d(t,{Z:()=>s});var i=n(281098),o=n(667294),a=n(20256),l=n(785893);let s=({inCommentFeedPreview:e,isFirstTaggedUserAuthor:t,lineHeight:n,marginBottom:s,marginEnd:r,shouldShowFirstNameOnly:d,size:c,tags:m,taggedUsers:u,text:p})=>{(0,o.useEffect)(()=>{(0,i.Z)("TaggedText","/app/packages/comment/TaggedText.tsx")},[]);let h=(0,o.useRef)(null),g=(e,t)=>(0,l.jsx)(a.xv,{inline:!0,overflow:"normal",size:c,children:(0,l.jsx)(a.xu,{dangerouslySetInlineStyle:{__style:{lineHeight:n,overflowWrap:"anywhere",display:"inline"}},"data-test-id":"text-container",children:e})},t);return(0,l.jsx)(a.xu,{dangerouslySetInlineStyle:{__style:{whiteSpace:"pre-wrap",wordWrap:"break-word",marginBottom:s}},children:(()=>{if(!m.length||!u||m.length!==u.length)return g(p,"1");let i=0,o=[];return m.forEach((n,s)=>{let r=p.substring(i,n.offset);i=n.offset+n.length;let m=p.substring(n.offset,i);o=o.concat(g(r,`${s}a`)).concat(((n,i,o,s)=>{let r=d||0===o&&t?u[o].first_name||u[o].username[0]:i;return(0,l.jsx)(a.xv,{color:n,inline:!0,overflow:"normal",size:c,weight:"bold",children:e?r:(0,l.jsx)(a.rU,{display:"inlineBlock",href:`/${u[o].username}`,underline:"hover",children:r})},s)})(n.color,m,s,`${s}b`))}),o=o.concat(g(p.substring(i),"2")),(0,l.jsx)(a.xu,{dangerouslySetInlineStyle:{__style:{lineHeight:n}},display:d?"flex":void 0,marginEnd:r??3,position:"relative",children:(0,l.jsx)(a.xv,{ref:h,inline:!0,lineClamp:e?1:void 0,size:c,children:o})})})()})}},296691:function(e,t,n){n.d(t,{A9:()=>g,F1:()=>k,Ff:()=>j,G5:()=>w,G_:()=>C,Gu:()=>b,LH:()=>s,Rv:()=>m,TJ:()=>p,Ty:()=>a,WU:()=>f,XU:()=>c,_q:()=>A,i$:()=>y,iB:()=>l,je:()=>r,mi:()=>P,o:()=>_,pW:()=>h,qJ:()=>S,sp:()=>T,uC:()=>d,xA:()=>u,yQ:()=>I,yW:()=>v,zs:()=>x});var i=n(20256),o=n(473728);let a=new i.Ry(3),l=48,s=56,r="sm",d=500,c=1,m=Object.freeze({TOP:0,REPLY_TO_TRIED:1,REPLY_TO_AGGREGATED:2}),u=Object.freeze({PHOTO:0,STICKER:1,PIN:2}),p="comment_featured_ids",h="did_it_featured_ids",g={NONE:"none",WARNING:"warning",BLOCK:"block"},_="transparent",f="#efefef",y=(e,t)=>e?(0,o.Z)(t.ngettext('{{ count }} Comment', '{{ count }} Comments', e, 'closeup.commentThread.heading.commentCount', 'Comment count on a Pin. count: number of comments'),{count:e.toString()}):t._('No comments yet', 'closeup.commentThread.heading.noComments', 'Prompt for user to comment on Pin'),x=(e,t,n,i)=>{let o=t.map(t=>({...t,offset:(t.offset||0)+(i?0:e.length+1),color:"shopping"}));return i?o:[{offset:0,length:e.length,color:n?"light":"dark"},...o]},v=e=>e._('Insight heading icon', 'closeupCommentModuleHeading.icon', 'Icon displayed in the comment module heading'),b=e=>e._('No comments yet', 'emptyCommentThread.noComments.heading', 'Text shown when there are no comments yet'),C=e=>e._('Post', 'commentComposer.button.post', 'Post new comment'),j=e=>e._('posted a photo', 'comment.preview.text.photo', 'Comment preview text for an image that a user posted'),k=e=>e._('posted a sticker', 'comment.preview.text.sticker', 'Comment preview text for a sticker that a user posted'),w=e=>e._('Select an emoji', 'emojitray.button.accessibilityLabel', 'Accessibility label for emoji tray button'),P=e=>e._('Select a photo', 'photoModal.button.accessibilityLabel', 'Accessibility label for photo modal button'),T=e=>e._('Select a sticker', 'stickerTray.button.accessibilityLabel', 'Accessibility label for sticker tray button'),I=e=>e._('Text editor', 'EditorWithMentions.container', 'Tappable area for the editor container'),A=e=>e._('Top Comment', 'closeupCommentModuleHeading.heading.topComment', 'Top Comment heading for the comment module'),S=e=>[w(e),P(e),C(e),T(e),I(e)]},436873:function(e,t,n){n.d(t,{Z:()=>i});let i=e=>e?.url!==void 0},502066:function(e,t,n){n.d(t,{G:()=>u,Kl:()=>p,vo:()=>m});var i=n(667294),o=n(729434),a=n(791948),l=n(914071),s=n(785893);let r=()=>n.e("83726").then(n.bind(n,3571)),{Provider:d,get:c}=(0,o.Z)("NativeEngagements");function m({children:e}){let[t,n]=(0,l.Z)(r,[]);(0,a.Z8)("NativeInteractionsResource",e=>{n({type:"FETCH_COMPLETE",payload:e})}),(0,a.my)("NativeInteractionsResource",e=>{n({type:"FETCH_MORE_COMPLETE",payload:e})});let o=(0,i.useMemo)(()=>({dispatch:n,nativeEngagements:t}),[n,t]);return(0,s.jsx)(d,{value:o,children:e})}function u(){let{dispatch:e}=c();return(0,i.useMemo)(()=>({nativeEngagementsHiddenForUser:t=>{e({type:"NATIVE_ENGAGEMENT_HIDDEN_FOR_USER",payload:{userId:t}})}}),[e])}function p(){let{nativeEngagements:e}=c();return e}},790427:function(e,t,n){n.d(t,{$8:()=>c,Dk:()=>d,Fk:()=>o,fS:()=>r,lI:()=>a,mS:()=>s,qW:()=>l});var i=n(20256);let o=new i.Ry(1),a=new i.Ry(3),l=2,s=new i.Ry(l),r=3,d=new i.Ry(100),c=new i.H3([d])},718214:function(e,t,n){n.d(t,{B:()=>z,Z:()=>D});var i,o,a,l=n(281098),s=n(667294),r=n(581722);n(167912);var d=n(20256),c=n(315787),m=n(821342),u=n(28427),p=n(422578),h=n(244311),g=n(915131),_=n(221020),f=n(808660);let y=function({graphQLMutation:e,legacyOperation:t,dataKeyOrStrategy:n}){let i="Strategy"===n.kind?n.strategy:"GraphQL"===(0,_.g)(n.fragmentRef).kind?"GraphQL":"Legacy",[o,a]=(0,s.useState)(!1);switch((0,f.Z)(i,()=>(0,h.getFragment)(e).name),i){case"GraphQL":{let[t,n]=(0,p.useMutation)(e);return[(0,s.useCallback)(({variables:e,onCompleted:n,onError:i,updater:o,uploadables:a,optimisticUpdater:l,optimisticResponse:s,configs:r,onUnsubscribe:d})=>{t({variables:e,onCompleted:(e,t)=>{n&&n({kind:"GraphQL",data:e},t)},onError:i,updater:o,uploadables:a,optimisticUpdater:l,optimisticResponse:s,configs:r,onUnsubscribe:d})},[t]),n]}case"Legacy":return[(0,s.useCallback)(e=>{a(!0),t(e.variables).then(t=>{e.onCompleted&&e.onCompleted({kind:"Legacy",data:t},null)}).catch(t=>{e.onError&&e.onError(t)}).finally(()=>{a(!1)})},[t]),o];default:return(0,g.Z)(i,"Unknown mode")}};var x=n(675973),v=n(886981),b=n(647709),C=n(341742),j=n(448505),k=n(7872),w=n(105433),P=n(542092),T=n(716751),I=n(611134),A=n(32082),S=n(793698),L=n(438235),E=n(785893);let z=({aggregatedPinDataId:e,featuredCommentIds:t,featuredDidItIds:n,isDesktop:i,isReversed:o=!1,noCache:a=!1,orbacSubjectId:l=""})=>({name:"UnifiedCommentsResource",options:{aggregated_pin_id:e,comment_featured_ids:t,did_it_featured_ids:n,page_size:i?10:25,redux_normalize_feed:!0,is_reversed:o,...l?{orbac_subject_id:l}:{}},noCache:a}),R=(void 0!==i||(i=n(316387)).hash&&"38e173ab2c3107ebc5b3da9f216fac98"!==i.hash&&console.error("The definition of 'CommentThreadContainer_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),i),D=({isReadOnly:e,pinKey:t,scrollContainer:i,showingCloseupCommentModule:p,viewParameter:h,toggleComposerForReply:g,openMwebOverflowMenu:_})=>{(0,s.useEffect)(()=>{(0,l.Z)("CommentThreadContainer","/app/www/comments/CommentThreadContainer.tsx")},[]);let{comment_id:f}=(0,L.Z)(),D=(0,r.I0)(),Z=(0,b.HG)(),M=(0,m.Z)(),O=(0,x.Z)().checkExperiment("web_use_mutation_or_legacy_experiment").anyEnabled,F=(0,u.Z)(R,t),N=(F?.aggregatedPinData?.commentCount||0)+(F?.aggregatedPinData?.didItData?.imagesCount||0),H=F?.aggregatedPinData?.entityId,U=F?.closeupAttribution?.entityId,K=F?.closeupAttribution?.username,W=F?.commentsDisabled,B=N>0&&!F?.commentsDisabled,G=!!F?.videos?.videoList,$=F?.entityId,V=F?.pinner?.entityId,q=F?.storyPinData?.entityId,J=(0,s.useRef)(B),Q=(0,j.Z)(),X=(0,k.lJ)(M,Q),Y=O?"GraphQL":"Legacy",[ee]=y({dataKeyOrStrategy:{kind:"Strategy",strategy:Y},graphQLMutation:(void 0!==o||(o=n(650345)).hash&&"6abad0b1546231dd9301ca5510fb88f5"!==o.hash&&console.error("The definition of 'CommentThreadContainerLikeMutation' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),o),legacyOperation:({userDidItData:e})=>(0,I.aX)({didItDataId:e,orbacSubjectId:X})}),[et]=y({dataKeyOrStrategy:{kind:"Strategy",strategy:Y},graphQLMutation:(void 0!==a||(a=n(206e3)).hash&&"e8e5a11ac4f4d2e8c4a2ed9c7ee3c073"!==a.hash&&console.error("The definition of 'CommentThreadContainerUnLikeMutation' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),a),legacyOperation:({userDidItData:e})=>(0,I.Wx)({didItDataId:e,orbacSubjectId:X})}),en=(0,v.Z)(J.current&&H?z({aggregatedPinDataId:H,featuredCommentIds:f?[f]:[],isDesktop:Z}):null),{removeUnauthCommentPinId:ei,unauthCommentPinId:eo}=(0,T.o)(),ea=(0,w.lV)(),{toggleAggregatedCommentHelpful:el,toggleAggregatedCommentLike:es}=(0,w.nf)(),er=(0,S.dM)(),ed=(0,r.v9)(e=>(0,A.Z)(e,{aggregatedPinDataId:H,aggregatedComments:ea,users:er})),[ec,em]=(0,s.useState)(void 0);(0,C.Z)(()=>{!Z&&M.isAuth&&eo&&$&&eo===$&&ei()}),(0,s.useEffect)(()=>{let e=()=>{let t=!!i&&i.scrollTop+i.clientHeight+10>=i.scrollHeight;en&&!en.isFetching&&(en.isAtEnd?i?.removeEventListener("scroll",e):t&&en.fetchMore())};return i?.addEventListener("scroll",e),()=>{i?.removeEventListener("scroll",e)}},[en,i]);let eu=2*(!Z&&!W);return(0,E.jsx)(s.Fragment,{children:(0,E.jsx)(d.xu,{display:"flex",height:Z||W||0!==ed.length?void 0:"100%",marginTop:Z?6:eu,width:"100%",children:(0,E.jsx)(c.Z,{aggregatedPinDataId:H,closeupAttributionId:U,closeupAttributionUsername:K,comments:ed,commentsDisabled:W,isDesktop:Z,isReadOnly:e,isVideo:G,openOverflowMenu:_,parentId:H??"",parentType:P.o.pin,pinId:$,pinnerId:V,reactionListCommentId:ec,showingCloseupCommentModule:p,showReactionListForComment:em,storyPinDataId:q,toggleHelpful:(e,t,n)=>()=>{n?D((0,I.YH)({didItDataId:e,isMarkedHelpfulByMe:t,orbacSubjectId:X})):el({aggregatedCommentId:e,isMarkedHelpfulByMe:t,orbacSubjectId:X})},toggleLike:(e,t,n)=>()=>{n?t?et({variables:{userDidItData:e},onCompleted:(n,i)=>{n&&!i&&D((0,I.uL)(e,!t))}}):ee({variables:{userDidItData:e},onCompleted:(n,i)=>{n&&!i&&D((0,I.uL)(e,!t))}}):es({aggregatedCommentId:e,isLikedByMe:t,orbacSubjectId:X})},toggleReplyComposer:g,userAvatarSize:"sm",viewParameter:h})})})}},716751:function(e,t,n){n.d(t,{o:()=>s,p:()=>r});var i=n(667294),o=n(729434),a=n(785893);let{Provider:l,get:s}=(0,o.Z)("Session");function r({children:e}){let[t,n]=(0,i.useState)(void 0),o=(0,i.useCallback)(()=>n(void 0),[]),s=(0,i.useMemo)(()=>({unauthCommentPinId:t,setUnauthCommentPinId:n,removeUnauthCommentPinId:o}),[t,o]);return(0,a.jsx)(l,{value:s,children:e})}},32082:function(e,t,n){n.d(t,{Z:()=>l});var i=n(442279),o=n(696323);let a={},l=(0,i.createSelector)((e,{aggregatedComments:t})=>t,({feeds:e},{aggregatedPinDataId:t})=>e[`${o.Z.UNIFIED_COMMENTS}:${t||""}`],({didItData:e})=>e,(e,{users:t})=>t??a,(e,t,n,i)=>{let o=new Set;return t?.map(({id:t,type:l})=>{if(o.has(t))return;o.add(t);let s="aggregatedcomment"===l.toLowerCase()?e[t]:n[t];if(!s)return;let r="user"in s&&("string"==typeof s.user?i[s.user]??a:s.user??a);return{...s,user:r??a}}).filter(e=>void 0!==e)||[]})},333651:function(e){e.exports="https://s.pinimg.com/webapp/commentHelpful-99007872.svg"},773655:function(e){e.exports="https://s.pinimg.com/webapp/commentLoved-7942dc4f.svg"}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/94447-a588159536b1bf45.mjs.map