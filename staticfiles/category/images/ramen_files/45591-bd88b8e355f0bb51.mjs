(self.modernJsonp=self.modernJsonp||[]).push([["45591"],{303151:function(e,t,i){i.d(t,{Z:()=>o});var n=i(69119),l=i(13882);function o(e,t){(0,l.Z)(2,arguments);var i=(0,n.Z)(e),o=(0,n.Z)(t);return i.getTime()===o.getTime()}},307595:function(e,t,i){i.r(t),i.d(t,{default:()=>l});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"CloseupVideoEndCard_pin",selections:[{args:null,kind:"FragmentSpread",name:"useCalculateMaxWidthAndHeightForSideBySideVariant_pin"}],type:"Pin",abstractKey:null};n.hash="e04be51b4be0a2585e7803d004fa83b7";let l=n},60533:function(e,t,i){i.r(t),i.d(t,{default:()=>l});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"CloseupVideoNonDuplo_pin",selections:[{args:null,kind:"FragmentSpread",name:"CloseupVideoEndCard_pin"},{args:null,kind:"FragmentSpread",name:"VideoWithContextLogging_pin"},{args:null,kind:"FragmentSpread",name:"useCalculateMaxWidthAndHeightForSideBySideVariant_pin"}],type:"Pin",abstractKey:null};n.hash="53ae9ecd15f057f744460205e5d495fd";let l=n},35312:function(e,t,i){i.r(t),i.d(t,{default:()=>l});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"StoryPinBlock_pin",selections:[{args:null,kind:"FragmentSpread",name:"StoryPinStickerBlockCloseup_pin"}],type:"Pin",abstractKey:null};n.hash="8bb1bb1f7bafeed0fe43bed44ef12d2a";let l=n},303965:function(e,t,i){i.r(t),i.d(t,{default:()=>l});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"StoryPinStickerBlockCloseup_pin",selections:[{alias:null,args:null,kind:"ScalarField",name:"description",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"entityId",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"gridTitle",storageKey:null},{alias:"imageSpec_236x",args:[{kind:"Literal",name:"spec",value:"236x"}],concreteType:"ImageDetails",kind:"LinkedField",name:"images",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"url",storageKey:null}],storageKey:'images(spec:"236x")'},{alias:null,args:null,concreteType:"RichPinGridData",kind:"LinkedField",name:"richSummary",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"displayName",storageKey:null},{alias:null,args:null,concreteType:"RichPinProductMetadata",kind:"LinkedField",name:"products",plural:!0,selections:[{alias:null,args:null,concreteType:"OfferSummary",kind:"LinkedField",name:"offerSummary",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"price",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"maxPrice",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null}],type:"Pin",abstractKey:null};n.hash="7e8d917850c8329247291df0d281a59b";let l=n},111419:function(e,t,i){i.r(t),i.d(t,{default:()=>l});let n={argumentDefinitions:[],kind:"Fragment",metadata:null,name:"useCalculateImageContainerDimension_pin",selections:[{args:null,kind:"FragmentSpread",name:"useCalculateMaxWidthAndHeightForSideBySideVariant_pin"}],type:"Pin",abstractKey:null};n.hash="86a6c49cecdb70d77f786a1965756cf9";let l=n},331047:function(e,t,i){var n,l,o,a;i.r(t),i.d(t,{default:()=>r});let s=(n={alias:null,args:null,kind:"ScalarField",name:"domain",storageKey:null},l={alias:null,args:null,kind:"ScalarField",name:"link",storageKey:null},a=[{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"officialUser",plural:!1,selections:o=[{alias:null,args:null,kind:"ScalarField",name:"firstName",storageKey:null}],storageKey:null}],{argumentDefinitions:[],kind:"Fragment",metadata:null,name:"useCalculateMaxWidthAndHeightForSideBySideVariant_pin",selections:[{alias:null,args:null,concreteType:"PinCarouselData",kind:"LinkedField",name:"carouselData",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"index",storageKey:null},{alias:null,args:null,concreteType:"PinCarouselSlot",kind:"LinkedField",name:"carouselSlots",plural:!0,selections:[n,l],storageKey:null}],storageKey:null},{alias:null,args:null,concreteType:"User",kind:"LinkedField",name:"closeupAttribution",plural:!1,selections:o,storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"closeupUnifiedTitle",storageKey:null},n,{alias:null,args:null,kind:"ScalarField",name:"gridTitle",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"isEligibleForPdp",storageKey:null},l,{alias:null,args:null,concreteType:"Domain",kind:"LinkedField",name:"linkDomain",plural:!1,selections:a,storageKey:null},{alias:null,args:null,concreteType:"UserWebsite",kind:"LinkedField",name:"linkUserWebsite",plural:!1,selections:a,storageKey:null},{alias:null,args:null,concreteType:"RichPinDataView",kind:"LinkedField",name:"richMetadata",plural:!1,selections:[{alias:null,args:null,concreteType:"RichPinProductMetadata",kind:"LinkedField",name:"products",plural:!0,selections:[{alias:null,args:null,concreteType:"OfferSummary",kind:"LinkedField",name:"offerSummary",plural:!1,selections:[{alias:null,args:null,kind:"ScalarField",name:"price",storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"standardPrice",storageKey:null}],storageKey:null}],storageKey:null}],storageKey:null},{alias:null,args:null,kind:"ScalarField",name:"trackedLink",storageKey:null}],type:"Pin",abstractKey:null});s.hash="b2a27d44d1f3dbd42301b82866212272";let r=s},856782:function(e,t,i){i.d(t,{S:()=>n,Z:()=>l});let n=1e3,l=3},112931:function(e,t,i){i.d(t,{ZP:()=>m,GJ:()=>p});var n,l=i(667294);i(422578);var o=i(592821),a=i(979904),s=i(139707),r=i(974297),d=i(28427),c=i(611499),u=i(601686);let h=(void 0!==n||(n=i(111419)).hash&&"86a6c49cecdb70d77f786a1965756cf9"!==n.hash&&console.error("The definition of 'useCalculateImageContainerDimension_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),n);function p(e,t){return`${Math.floor(e/t*1e4)/1e4} / 1`}function m({carouselData:e,imageToDisplayWidthRatio:t=1,mainImage:i={width:1,height:1,url:""},maxCloseupImageWidth:n,pinKey:p,shouldPadImage:m=!1}){let _=(0,d.Z)(h,p),{peekCloseupEnabled:g,viewportSize:y}=(0,u.x4)(),{numericValues:f}=(0,o.Re)(),{maxHeight:x}=(0,a.Z)({pinKey:_}),{fiftyPercentHeight:v,fiftyPercentWidth:b,maxHeight:P,maxWidth:S}=f??{},{peekRedesignFastFollowsEnabled:w}=(0,s.Z)(i);return(0,l.useMemo)(()=>{let l,o=n-c.d2,a=Math.min(m?o:n,S??1/0,b??1/0),s=Math.min(...[i,...e?.carousel_slots?.map(e=>{var t;return(0,r.Z)(e.images)||((t=e.videos?.video_list)?t.V_720P?.url?t.V_720P:t.V_HLSV4?.url?t.V_HLSV4:t.V_HLSV3_MOBILE?.url?t.V_HLSV3_MOBILE:t.V_HLSV3_WEB?.url?t.V_HLSV3_WEB:null:null)}).filter(e=>!!e)||[]].map(({width:e,height:t})=>(e??1)/(t??1))),d=Math.floor(a*(e?t:1)/s),u="sm"===y?v:P;l=g?u??d:"number"==typeof x?x:d;let h=w?void 0:l,p=h?Math.min(d,h):d,_=Math.min(a*(g?p/d:1),S??1/0,b??1/0),{containerAspectRatio:f,letterBoxedWidth:k,letterBoxedHeight:C}=function(e,t,i){let n,l,o=e?.width/e.height,a=t/i;return o>a?(n=t,l=t/o):(n=i*o,l=i),{containerAspectRatio:a,letterBoxedWidth:n,letterBoxedHeight:l}}(i,_,p);return{containerAspectRatio:f,containerHeight:p,containerWidth:_,horizontalOffset:(_-k)/2,letterBoxedHeight:C,letterBoxedWidth:k,letterBoxAspectRatio:k/C,verticalOffset:(p-C)/2}},[n,m,i,e,t,y,v,P,g,x,w,S,b])}},899117:function(e,t,i){i.d(t,{Z:()=>n});let n=(e,t)=>{let i,{height:n=0,width:l=0}=t||{};switch(e){case"enabled_15":i=.15;break;case"enabled_25":i=.25;break;default:i=.35}return l/n<i}},179639:function(e,t,i){i.d(t,{Z:()=>g});var n=i(281098),l=i(667294),o=i(20256),a=i(592821),s=i(979904),r=i(869985),d=i(980787),c=i(19585),u=i(399806),h=i(218831),p=i(601686),m=i(785893);class _ extends l.PureComponent{constructor(...e){var t,i,n;super(...e),t="startAudiblePlayTime",i=this.props.muted?null:new Date,(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:n+"")in this?Object.defineProperty(this,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):this[t]=i}componentDidUpdate(e){e.muted!==this.props.muted&&(this.startAudiblePlayTime=this.props.muted?null:new Date)}componentWillUnmount(){let{musicRecordingId:e,muted:t,pinId:i,video:n}=this.props;if(e&&!t&&this.startAudiblePlayTime&&Date.now()-this.startAudiblePlayTime.getTime()>=2e3){let{hlsv3:t,mp4:l}=(0,u.Z)({vEXP3:n.video_list?.V_EXP3,vEXP4:n.video_list?.V_EXP4,vEXP5:n.video_list?.V_EXP5,vEXP6:n.video_list?.V_EXP6,vEXP7:n.video_list?.V_EXP7,v720P:n.video_list?.V_720P,vHLSV3MOBILE:n.video_list?.V_HLSV3_MOBILE})||{},o=(l||t)?.duration||0;this.props.logContextEvent({event_type:8999,object_id_str:e,aux_data:{pin_id:i,story_pin_music_duration:o}})}}render(){let{activePageIndex:e,aspectRatio:t,blockHeight:i,blockWidth:n,closeupBodyWidth:l,closeupStoryPinViewability:a,closeupWithinMasonryEnabled:s,customEndCard:d,isPlaying:c,muted:h,onEnded:p,onUpdateVideoInfo:_,pageIndex:g,pin:y,pinId:f,maxHeight:x,video:v,videoThumbnailStartTime:b}=this.props,{hlsv3:P,mp4:S}=(0,u.Z)({vEXP3:v.video_list?.V_EXP3,vEXP4:v.video_list?.V_EXP4,vEXP5:v.video_list?.V_EXP5,vEXP6:v.video_list?.V_EXP6,vEXP7:v.video_list?.V_EXP7,v720P:v.video_list?.V_720P,vHLSV3MOBILE:v.video_list?.V_HLSV3_MOBILE})??{},w=S||P;if(!w)return null;let{height:k,thumbnail:C,width:j}=w,E=t??(j??1)/(k??1),I={height:"100%",left:"0",top:"0",width:"100%"},T=s&&l?(l??n)/(Number(x)??i):n/i;if(!s&&Math.abs(T-E)>.01){if(T<E){let e=100*E/T;I.width=`${e}%`,I.left=`-${(e-100)/2}%`}else if(T>E){let e=100*T/E;I.height=`${e}%`,I.top=`-${(e-100)/2}%`}}let A="number"==typeof e&&g<=e+3;return(0,m.jsx)(o.xu,{height:"100%",overflow:"hidden",position:"relative",width:"100%",children:(0,m.jsx)(o.xu,{height:"100%",position:"absolute",width:"100%",children:A||c||b?(0,m.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:I},position:"absolute",children:(0,m.jsx)(r.Z,{aspectRatio:s?T:t,autoplay:c,closeupStoryPinViewability:a,contextLogData:{component:0===g?227:228,element:10957,objectId:f,story_pin_page_id:g,view:3,viewParameter:157},customEndCard:d,customThumbnail:C,isPromoted:!1,loop:!1,muted:h,objectFit:S?s?"contain":"cover":void 0,onEnded:()=>{p&&p(g)},onTimeChange:({time:e})=>{_&&"number"==typeof w.duration&&w.duration>0&&_({currentTime:e,duration:w.duration/1e3})},pinId:f,pinKey:null===y?null:{type:"Legacy",data:y},preferMp4:!!S,showControls:"hover",variant:"storyPin",video:{id:v.id,hlsv3:P,mp4:S},videoThumbnailStartTime:b})}):C&&(0,m.jsx)(o.Ee,{alt:this.props.i18n._('Video cover image', 'closeup.storyPin.videoCover', 'cover image displayed for a video'),fit:"cover",naturalHeight:k??1,naturalWidth:j??1,src:C})})})}}function g(e){(0,l.useEffect)(()=>{(0,n.Z)("StoryPinVideo","/app/common/react/components/closeup/StoryPin/StoryPinVideo.tsx")},[]);let{logContextEvent:t}=(0,d.u)(),{pin:i}=e,o=(0,c.ZP)(),{closeupWithinMasonryEnabled:r}=(0,p.x4)(),{closeupBodyWidth:u}=(0,h.K)(),{maxHeight:g}=(0,a.Re)(),{maxHeight:y}=(0,s.Z)({pinKey:null===i?null:{type:"Legacy",data:i}});return(0,m.jsx)(_,{...e,closeupBodyWidth:u,closeupWithinMasonryEnabled:r,i18n:o,logContextEvent:t,maxHeight:r?y:g})}},248762:function(e,t,i){i.d(t,{Z:()=>Y});var n,l,o=i(281098),a=i(667294);i(167912);var s=i(20256),r=i(112931),d=i(592821),c=i(312048),u=i(883817),h=i(980787),p=i(886981),m=i(785893);let _=({block:{block_style:{height:e=0,width:t=0,x_coord:i=0,y_coord:n=0,rotation:l=0}={},original_comment_id:r},horizontalOffset:_=0,pageAspectRatio:g,scaleFactor:y,verticalOffset:f=0})=>{(0,a.useEffect)(()=>{(0,o.Z)("IdeaPinCommentReplyStickerBlock","/app/common/react/components/closeup/StoryPin/IdeaPinCommentReplyStickerBlock.tsx")},[]);let{logContextEvent:x}=(0,h.u)(),v=d._B/g,b=t*d._B*y/100,P=i*d._B*y/100+_,S=(0,c.s0)(),{data:w}=(0,p.Z)({name:"AggregatedCommentResource",options:{commentId:r,field_set_key:"comment_reply_sticker"}});return(0,m.jsx)(s.xu,{dangerouslySetInlineStyle:{__style:{left:P,top:n*v*y/100+f,transform:`rotate(${l}deg)`}},display:"flex",height:e*v*y/100,margin:-1,padding:1,position:"absolute",rounding:2,width:b,zIndex:u.B_,children:(0,m.jsx)(s.iP,{onTap:()=>{x({event_type:102,view_type:1,component:227,element:12541,aux_data:{comment_id:r}}),w?.pin_id&&S(`/pin/${w.pin_id}/comments/${r||""}`)},rounding:"pill"})})};var g=i(291892),y=i(7525);function f({src:e,fallbackSrc:t,...i}){(0,a.useEffect)(()=>{(0,o.Z)("ImageWithFallback","/app/common/react/components/closeup/StoryPin/renderer/ImageWithFallback.tsx")},[]);let n=(0,y.Z)(e);return(0,m.jsx)(g.Z,{...i,src:n?e:t})}var x=i(581722);function v({isUseCache:e,signature:t}){return(0,x.v9)(({pinbuilder:i})=>{let{storyPinItemBlocks:n}=i;if(!e)return null;for(let e of Object.keys(n))if(n[e].media?.signatureEdited===t||n[e].media?.signature===t)return n[e];return null})}var b=i(111923),P=i(865540),S=i(982166),w=i(19585),k=i(542092);let C=({aggregatedCommentId:e,onDismiss:t})=>{(0,a.useEffect)(()=>{(0,o.Z)("StoryPinQuestionStickerReplyModal","/app/common/react/components/closeup/StoryPin/StoryPinQuestionStickerReplyModal.tsx")},[]);let i=(0,w.ZP)(),n=(0,P.Z)(),l=(0,b.Z)(),[r,d]=(0,a.useState)(""),c=(0,m.jsx)(s.kC,{justifyContent:"end",children:(0,m.jsx)(s.zx,{color:"red",disabled:!r,onClick:()=>{(async()=>{await l({fromUnifiedComment:!0,objectType:k.o.aggregatedComment,objectId:e,tags:"[]",text:r})})(),t()},text:i._('Post', 'ideapin.questionsticker.replymodal.postbutton', 'Post reply to creator Q&A question')})});return(0,m.jsx)(S.ZP,{accessibilityModalLabel:"reply to creator Q and A question",align:"start",footer:c,heading:i._('Reply', 'ideapin.questionsticker.replymodal', 'Reply to creator Q&A question'),onDismiss:t,children:(0,m.jsx)(s.xu,{paddingX:8,paddingY:1,children:(0,m.jsx)(s.Kx,{id:"ideaPinQuestionStickerReplyModalTextArea",onChange:({value:e})=>{d(e)},placeholder:n?i._('Your reply will show up as a public comment on this Pin.', 'pin.questionsticker.replymodal.placeholder', 'Placeholder for creator Q&A reply textarea'):i._('Your reply will show up as a public comment on this Idea Pin.', 'ideapin.questionsticker.replymodal.placeholder', 'Placeholder for creator Q&A reply textarea'),value:r})})})};var j=i(744862),E=i(821342),I=i(28427),T=i(302148),A=i(123317),z=i(294711);let F=(void 0!==n||(n=i(303965)).hash&&"7e8d917850c8329247291df0d281a59b"!==n.hash&&console.error("The definition of 'StoryPinStickerBlockCloseup_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),n);function V({block:e,elementType:t,horizontalOffset:i=0,onFlyoutOpen:n,pageAspectRatio:l,pageIndex:r,pinKey:_,scaleFactor:g,tooltipElementType:y,verticalOffset:f=0,videoPinProgress:x}){(0,a.useEffect)(()=>{(0,o.Z)("StoryPinStickerBlock","/app/common/react/components/closeup/StoryPin/StoryPinStickerBlock.tsx")},[]);let{logContextEvent:v}=(0,h.u)(),[b,P]=(0,a.useState)(!1),[S,k]=(0,a.useState)(!1),V=(0,a.useRef)(null),L=(0,c.s0)(),M=(0,w.ZP)(),R=(0,I.Z)(F,_),Z=(0,E.Z)(),{block_style:{height:B=0,width:O=0,x_coord:D=0,y_coord:H=0,rotation:K=0}={},end_time:W,error_message:$,interactive_sticker_type:N=null,is_removed:U,is_valid:X,start_time:q,sticker_data:G,type:J}=e,Y=R?.entityId,{board_id:Q,question_comment_id:ee}=G||{},{image_small_url:et,full_name:ei,username:en=""}=e.user??{},el=null,eo=X&&5===N&&!!Q,ea=X&&7===N&&!!ee,es=(0,p.Z)(Q&&eo?{name:"BoardResource",options:{field_set_key:"tagged_board_preview",board_id:Q}}:null),{is_collaborative:er,pin_count:ed,url:ec}=es.data||{};J===A.h8.PRODUCT_STICKER?el=Y?`/pin/${Y}/`:"/":J===A.h8.MENTION_STICKER?el=`/${en}/`:eo&&(el=es.isLoaded?`${ec}`:null);let eu=d._B/l,eh=O*d._B*g/100,ep=D*d._B*g/100+i,{currentTime:em}=x||{},e_=!(0,z.Z)({currentTime:em,endTime:W,startTime:q}),eg=()=>{v({event_type:123,component:228,element:y,view_type:3,view_parameter:157,aux_data:{story_pin_page_id:r}}),P(!1)};(0,a.useEffect)(()=>(document.addEventListener("scroll",()=>{P(!1)}),()=>document.removeEventListener("scroll",()=>{P(!1)})),[]);let ey=()=>{let e=null,t=Z.isAuth?Z?.avatar_color_index:void 0;switch(J){case A.h8.PRODUCT_STICKER:let{gridTitle:i,imageSpec_236x:n,richSummary:l,description:o}=R||{},{displayName:r,products:d}=l||{},c=((d||[])[0]||{}).offerSummary||{},{price:u,maxPrice:h}=c||{},p=!!c&&(!!u||!!h),_=r||i||o;e=(0,m.jsxs)(a.Fragment,{children:[(0,m.jsx)(s.xu,{flex:"none",children:(0,m.jsx)(s.zd,{height:40,rounding:3,wash:!0,width:40,children:n?.url&&(0,m.jsx)(s.Ee,{alt:"",color:"lightGray",fit:"cover",naturalHeight:1,naturalWidth:1,src:n.url})})}),(0,m.jsx)(s.xu,{flex:"grow",paddingX:2,children:p?(0,m.jsxs)(s.kC,{alignContent:"center",alignItems:"stretch",direction:"column",flex:"grow",justifyContent:"center",children:[(0,m.jsx)(s.xv,{color:"shopping",lineClamp:1,size:"100",weight:"bold",children:u}),(0,m.jsx)(s.xv,{lineClamp:1,size:"100",children:_})]}):(0,m.jsx)(s.xv,{lineClamp:1,size:"100",children:_})}),(0,m.jsx)(s.xu,{flex:"none",children:(0,m.jsx)(s.Sj,{bgColor:"transparent",icon:"arrow-forward",iconColor:"darkGray",size:"xs"})})]});break;case A.h8.MENTION_STICKER:e=(0,m.jsxs)(a.Fragment,{children:[(0,m.jsx)(s.xu,{flex:"none",children:(0,m.jsx)(j.qE,{color:t,name:ei??"",size:"sm",src:et??void 0})}),(0,m.jsx)(s.xu,{flex:"grow",paddingX:2,children:(0,m.jsx)(s.xv,{lineClamp:1,size:"200",weight:"bold",children:ei})}),(0,m.jsx)(s.xu,{flex:"none",children:(0,m.jsx)(s.Sj,{bgColor:"transparent",icon:"arrow-forward",iconColor:"darkGray",size:"xs"})})]});break;case A.h8.GENERIC_STICKER:e=[5].includes(N)?X?es.isLoaded?(0,m.jsxs)(a.Fragment,{children:[(0,m.jsxs)(s.xu,{flex:"grow",paddingX:2,children:[(0,m.jsx)(s.xv,{lineClamp:1,size:"100",weight:"bold",children:er?M._('Explore this group board', 'closeup.StoryPin.stickerBlock.boardSticker.clickLabel', 'Label explaining click action when group board tag flyout showing'):M._('Explore this board', 'closeup.StoryPin.stickerBlock.boardSticker.clickLabel', 'Label explaining click action when board tag flyout showing')}),(0,m.jsx)(s.xv,{size:"100",children:(!!ed||0===ed)&&(0,T.nk)(M.ngettext('{{ pinCount }} Pin', '{{ pinCount }} Pins', ed, 'closeup.StoryPin.stickerBlock.boardSticker.boardLabel', 'Caption when board tag flyout that showing number of Pins on board'),{pinCount:ed})})]}),(0,m.jsx)(s.xu,{flex:"none",children:(0,m.jsx)(s.Sj,{bgColor:"transparent",icon:"arrow-forward",iconColor:"darkGray",size:"xs"})})]}):(0,m.jsxs)(s.xu,{alignItems:"center",direction:"row",display:"flex",flex:"grow",paddingY:2,children:[(0,m.jsx)(s.xu,{marginEnd:1,paddingX:2,children:(0,m.jsx)(s.xv,{color:"subtle",lineClamp:1,size:"100",children:M._('Loading board...', 'closeup.StoryPin.stickerBlock.boardSticker.loadingText', 'Label explaining board sticker still loading')})}),(0,m.jsx)(s.xH,{accessibilityLabel:M._('Board is loading', 'closeup.StoryPin.stickerBlock.boardSticker.loadingSpinnerText', 'Accessibility label for board loading spinner'),show:!0,size:"sm"})]}):(0,m.jsx)(s.xu,{paddingX:2,paddingY:2,children:(0,m.jsx)(s.xv,{color:"subtle",lineClamp:1,size:"200",weight:"bold",children:$})}):(0,m.jsx)(s.xu,{paddingX:2,paddingY:2,children:(0,m.jsx)(s.xv,{color:"subtle",lineClamp:1,size:"200",weight:"bold",children:M._('Sticker not supported yet', 'closeup.StoryPin.stickerBlock.genericStickerError', 'Label explaining this sticker has not been implemented yet')})});break;case A.h8.VTO_MAKEUP_STICKER:e=(0,m.jsx)(s.xv,{size:"300",weight:"bold",children:M._('Try this sticker on your phone!', 'closeup.storyPin.vtoMakeupSticker', 'Caption when @vitural-try-on-makeup tag is tapped for Web')})}return(0,m.jsx)(s.xu,{alignItems:"center","data-test-id":J,display:"flex",justifyContent:"center",padding:J===A.h8.PRODUCT_STICKER?1:3,width:"100%",children:U?(0,m.jsx)(s.xv,{color:"subtle",size:"200",weight:"bold",children:M._('Tag removed!', 'closeup.storyPin.stickerBlock', 'Caption when the tag is removed')}):e})};return(0,m.jsx)(a.Fragment,{children:e_?null:(0,m.jsxs)(s.xu,{ref:V,dangerouslySetInlineStyle:{__style:{left:ep,top:H*eu*g/100+f,transform:`rotate(${K}deg)`}},"data-test-id":(J||"")+"_container",display:"flex",height:B*eu*g/100+2*d.Xw,margin:-1,padding:1,position:"absolute",rounding:2,width:eh+2*d.Xw,zIndex:u.B_,children:[(0,m.jsx)(s.iP,{disabled:e_,onTap:b?eg:({event:e})=>{e_||(v({event_type:101,component:228,element:t,view_type:3,view_parameter:157,aux_data:{story_pin_page_id:r}}),ea?k(!0):(({event:e})=>{v({event_type:120,component:228,element:y,view_type:3,view_parameter:157,aux_data:{error_message:!X&&$?$:null,story_pin_page_id:r}}),P(!0),n&&(e.stopPropagation(),n())})({event:e}))},rounding:"pill"}),b&&(0,m.jsx)(s.mh,{zIndex:u.ej,children:(0,m.jsx)(s.J2,{_deprecatedShowCaret:!0,anchor:V.current,idealDirection:"up",onDismiss:eg,positionRelativeToAnchor:!1,size:U?"flexible":"sm",children:U?ey():(0,m.jsx)(s.iP,{fullWidth:!0,onTap:({event:e})=>{e.preventDefault(),U||(v({event_type:101,component:228,element:y,object_id_str:Y,view_type:3,view_parameter:157,aux_data:{story_pin_page_id:r}}),el?L(el):eg())},children:ey()})})}),!!ee&&S&&(0,m.jsx)(C,{aggregatedCommentId:ee,onDismiss:()=>{k(!1)}})]})})}var L=i(445698),M=i(47676),R=i(238187),Z=i(452750);function B({block:e,fontsLoaded:t,horizontalOffset:i=0,pageAspectRatio:n,scaleFactor:l,thumbnail:r,verticalOffset:d=0}){(0,a.useEffect)(()=>{(0,o.Z)("StoryPinTextBlock","/app/common/react/components/closeup/StoryPin/StoryPinTextBlock.tsx")},[]);let{block_style:c,style:u=A.Cc,text:h}=e,{alignment:p,font:_,font_size:g,highlight_color:y,vertical_alignment:f=A.Cc.vertical_alignment}=u,{hex_color:x=A.Cc.hex_color}=u??{},[v,b]=(0,a.useState)(0),[P,S]=(0,a.useState)([]),w=_||A.Cc.font,{name:k,default_size:C,letter_spacing:j,line_height:E}=w,I=(0,Z.Z)(w),T=Math.round(100*(c?.width||100))/1e4,z=Math.round(100*(c?.height||100))/1e4,F=Math.round(100*(c?.x_coord||0))/1e4,V=Math.round(100*(c?.y_coord||0))/1e4;(0,a.useEffect)(()=>{if(t){let e=(0,R.KV)({text:h,boxHeight:M.q8/n*z,boxWidth:M.q8*T,font:I,startFontSize:Math.floor(g||C||24)});S(e.lines),b(e.fontSize)}},[t,h]);let B=v*l,O=y?(0,A.pE)(B,E):{x:0,y:0},D=T*M.q8*l+2*O.x,H=z*(M.q8/n)*l+2*O.y,K=i+F*M.q8*l-O.x,W=r?`${100*V}%`:d+V*(M.q8/n)*l-O.y;return(0,m.jsx)(s.xu,{dangerouslySetInlineStyle:{__style:{left:K,top:W}},display:"flex",height:H,position:"absolute",width:D,children:(0,m.jsx)(s.xu,{dangerouslySetInlineStyle:{__style:(0,L.RK)({alignment:p,verticalAlignment:f})},children:(0,m.jsx)(s.xu,{display:"inlineBlock",maxWidth:"100%",children:(0,m.jsx)("p",{style:(0,L.BN)({fontSize:B,hexColor:x,letterSpacing:j,lineHeight:E,name:k}),children:P.map((e,t)=>(0,m.jsx)("span",{"data-gestalt-valid-html":"Text",style:(0,L.xm)({fontSize:B,hasText:e.text.length>0,highlightColor:y||null,lineHeight:E}),children:t===P.length-1?e.text:(0,m.jsxs)(a.Fragment,{children:[e.text," ",(0,m.jsx)("br",{})]})},`paragraphLine-${t}-${(h??"").substr(0,9)}`))})})})})}var O=i(179639);function D({ownerId:e}){(0,a.useEffect)(()=>{(0,o.Z)("StoryPinVideoPlaceholder","/app/common/react/components/closeup/StoryPin/StoryPinVideoPlaceholder.tsx")},[]);let t=(0,w.ZP)(),i=(0,E.Z)(),n=i.isAuth&&i.id===e;return(0,m.jsxs)(s.xu,{alignItems:"center",color:"tertiary",direction:"column",display:"flex",height:"100%",justifyContent:"center",width:"100%",children:[(0,m.jsx)(s.xv,{color:"inverse",children:n?t._('Your video is processing!', 'closeup.storyPin.videoPlaceholder', 'Let user know that their video is still processing'):t._('This video is still processing!', 'closeup.storyPin.videoPlaceholder', 'Let user know that this video is still processing')}),(0,m.jsx)(s.xv,{color:"inverse",children:t._('Check back in a few minutes.', 'closeup.storyPin.videoPlaceholder', 'Let user know to come back in a couple of minutes to view the video')})]})}var H=i(139707),K=i(934645),W=i(716920),$=i(956077),N=i(85574),U=i(601686),X=i(653621);function q({block:e,isActive:t,pwtTrackImageLoad:i,thumbnail:n}){let l,o=(0,w.ZP)(),{closeupWithinMasonryEnabled:a,isCloseupMediaViewerOpen:c,peekCloseupEnabled:u,showProductDetailPage:h}=(0,U.x4)(),p=(0,K.Z)({showProductDetailPage:h}),{borderStyle:_}=n||p?{}:(0,N.Z)({closeupWithinMasonryEnabled:a}),y=e.image?.images?.["750x"]||e.image?.images?.["474x"],{height:x=1,width:b=1}=y||{},P=v({isUseCache:!0,signature:e.image_signature}),{peekRedesignFastFollowsEnabled:S}=(0,H.Z)(y);return y||P?(l=n?"cover":a||S?"none":"contain",(0,m.jsx)(s.xu,{alignItems:u?"center":void 0,dangerouslySetInlineStyle:{__style:{..._,aspectRatio:a?(0,r.GJ)(b,x):void 0,contain:"strict",display:u?"grid":"block",justifySelf:a?"center":void 0}},height:a?"100%":"inherit",overflow:"hidden",width:a?void 0:"inherit",children:P?(0,m.jsx)(f,{_enableViewTransitions:!0,alt:o._('Story pin image', 'closeup.storypin.renderer', 'Alt text for story pin image'),color:d.yc,elementTiming:"StoryPinImageBlock-MainPinImage",fallbackSrc:P.media?.src??"",fit:l,isActive:t,naturalHeight:x,naturalWidth:b,onLoad:i,src:y?.url??"",suppressViewTransitionTags:c}):(0,m.jsx)(g.Z,{_enableViewTransitions:!0,alt:o._('Story pin image', 'closeup.storypin.renderer', 'Alt text for story pin image'),borderStyle:_,color:d.yc,elementTiming:"StoryPinImageBlock-MainPinImage",fetchPriority:a?"high":void 0,fit:l,isActive:t,naturalHeight:y?.height??1,naturalWidth:y?.width??1,onLoad:i,src:y?.url??"",suppressViewTransitionTags:c})})):null}function G({activePageIndex:e,block:t,closeupStoryPinViewability:i,customEndCard:n,isActive:l,isSplitLayout:o=!1,musicRecordingId:a,muted:r,onEnded:c,onUpdateVideoInfo:u,ownerId:h,pageAspectRatio:p,pageDimensions:_,pageIndex:g,pin:y,pinId:f,scaleFactor:x,stillLoading:b,videoThumbnailStartTime:P,thumbnail:S=!1}){let{block_style:{height:w=100,width:k=100,x_coord:C=0,y_coord:j=0}={},video:E}=t,{closeupWithinMasonryEnabled:I}=(0,U.x4)(),T=d._B/p,{height:A,width:z}=_,F=k*d._B*x/100,V=k<100?Math.min(Math.max(100,k)-Math.abs(C),k):Math.min(Math.max(k-Math.abs(C),0),100),L=w<100?Math.min(Math.max(100,w)-Math.abs(j),w):Math.min(Math.max(w-Math.abs(j),0),100),M=I?"100%":L*T*x/100,R=I?"100%":V*d._B*x/100,Z=Math.max(j,0)*T*x/100,B=Math.max(C,0)*d._B*x/100,H=v({isUseCache:!E,signature:t.video_signature});if(b)return null;let{media:K}=H||{},{duration:W,src:$}=K||{},N=!!$&&!!W;return E||N?!!(E?.video_list?.V_HLSV3_MOBILE||E?.video_list?.V_720P||N)&&(0,m.jsx)(s.xu,{height:o?"50%":"100%",overflow:"hidden",position:"relative",children:(0,m.jsx)(s.xu,{dangerouslySetInlineStyle:{__style:{alignSelf:"anchor-center",left:B,top:Z}},"data-test-id":"story-pin-video-block",height:S?A:M,overflow:"hidden",position:"absolute",width:S?z:R,children:(0,m.jsx)(O.Z,{activePageIndex:e,aspectRatio:p,blockHeight:S?A:w*T*x/100,blockWidth:S?z:F,closeupStoryPinViewability:i,customEndCard:n,isPlaying:l,musicRecordingId:a,muted:r,onEnded:c,onUpdateVideoInfo:u,pageIndex:g,pin:y,pinId:f,video:E||{video_list:{V_EXP7:{duration:W?1e3*W:0,url:$}}},videoThumbnailStartTime:P})})}):(0,m.jsx)(s.xu,{dangerouslySetInlineStyle:{__style:{left:B,top:Z}},height:M,position:"absolute",width:R,children:(0,m.jsx)(D,{ownerId:h})})}let J=(void 0!==l||(l=i(35312)).hash&&"8bb1bb1f7bafeed0fe43bed44ef12d2a"!==l.hash&&console.error("The definition of 'StoryPinBlock_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),l);function Y({activePageIndex:e,block:t,closeupStoryPinViewability:i,customEndCard:n,disableProductStickers:l,fontsLoaded:r,horizontalOffset:c,isActive:u,isSplitLayout:h=!1,musicRecordingId:p,muteVideos:g,onEnded:y,onFlyoutOpen:f,onUpdateVideoInfo:x,ownerId:v,pageAspectRatio:b,pageHeight:P,pageIndex:S,pageWidth:w,pin:k,pinId:C,previewOnly:j,pinKey:E,stillLoading:T=!1,thumbnail:z=!1,transform:F,verticalOffset:L,videoPinProgress:M,videoThumbnailStartTime:R}){(0,a.useEffect)(()=>{(0,o.Z)("StoryPinBlock","/app/common/react/components/closeup/StoryPin/renderer/StoryPinBlock.tsx")},[]);let Z=(0,I.Z)(J,E),{closeupWithinMasonryEnabled:O}=(0,U.x4)(),{block_style:{height:D=100,width:H=100,x_coord:K=0,y_coord:N=0}={},interactive_sticker_type:Y=null}=t,Q=(0,W.g)();if(0===D||0===H)return null;let ee=w/d._B;switch(t.type){case A.h8.PARAGRAPH:case A.h8.HEADING:return(0,m.jsx)(B,{block:t,fontsLoaded:r,horizontalOffset:c,pageAspectRatio:b,scaleFactor:ee,thumbnail:z,verticalOffset:L});case A.h8.VIDEO:return(0,m.jsx)(G,{activePageIndex:e,block:t,closeupStoryPinViewability:i,customEndCard:n,isActive:u,isSplitLayout:h,musicRecordingId:p,muted:g,onEnded:y,onUpdateVideoInfo:x,ownerId:v,pageAspectRatio:b,pageDimensions:{height:P,width:w},pageIndex:S,pin:k,pinId:C,scaleFactor:ee,stillLoading:T,thumbnail:z,videoThumbnailStartTime:R});case A.h8.IMAGE:let{scaleX:et=1,scaleY:ei=1}=F||{};return(0,m.jsx)(s.xu,{dangerouslySetInlineStyle:{__style:{display:O?"grid":"block",height:`${D}%`,left:`${K*et}%`,top:`${N*ei}%`,width:`${H}%`}},"data-test-id":"story-pin-image-block",overflow:"hidden",position:"absolute",children:(0,m.jsx)(q,{block:t,isActive:u,pwtTrackImageLoad:()=>{Q&&u&&(Q.addBinaryAnnotation("pin.id",C,"STRING"),Q.addBinaryAnnotation("video",!1,"BOOL"),Q.stop()),u&&((0,$.rt)("pin.id",C,"STRING"),(0,$.rt)("video",!1,"BOOL"),(0,$.Nx)(X.pM),(0,$.l7)(X._z))},thumbnail:z})});case A.h8.MENTION_STICKER:return!j&&(0,m.jsx)(V,{block:{...t},elementType:12120,horizontalOffset:c,onFlyoutOpen:f,pageAspectRatio:b,pageIndex:S,pinKey:null,scaleFactor:ee,tooltipElementType:12121,verticalOffset:L,videoPinProgress:M});case A.h8.GENERIC_STICKER:return!j&&(e=>{let t=5===Y;return(0,m.jsx)(V,{block:{...e},elementType:t?12827:12858,horizontalOffset:c,onFlyoutOpen:f,pageAspectRatio:b,pageIndex:S,pinKey:null,scaleFactor:ee,tooltipElementType:t?12828:12859,verticalOffset:L,videoPinProgress:M})})(t);case A.h8.PRODUCT_STICKER:return!j&&!l&&(0,m.jsx)(V,{block:{...t},elementType:12223,horizontalOffset:c,onFlyoutOpen:f,pageAspectRatio:b,pageIndex:S,pinKey:Z,scaleFactor:ee,tooltipElementType:12224,verticalOffset:L,videoPinProgress:M});case A.h8.VTO_MAKEUP_STICKER:return!j&&(0,m.jsx)(V,{block:{...t},elementType:12561,horizontalOffset:c,onFlyoutOpen:f,pageAspectRatio:b,pageIndex:S,pinKey:null,scaleFactor:ee,tooltipElementType:12561,verticalOffset:L,videoPinProgress:M});case A.h8.COMMENT_REPLY_STICKER:return t.type===A.h8.COMMENT_REPLY_STICKER&&!j&&(0,m.jsx)(_,{block:t,horizontalOffset:c,pageAspectRatio:b,scaleFactor:ee,verticalOffset:L});default:return null}}},995415:function(e,t,i){i.d(t,{Z:()=>n});let n=({carouselData:e,domain:t})=>{let i="",n=t||"";if(e){let{carouselSlots:t=[]}=e,l=e.index??0;t&&t[l]&&(i=t[l].link||"",n=t[l].domain||n)}return{carouselLink:i,currentDomain:n}}},979904:function(e,t,i){i.d(t,{Z:()=>p});var n,l=i(667294);i(422578);var o=i(995415),a=i(934645),s=i(28427),r=i(906498),d=i(644493),c=i(664897),u=i(601686);let h=(void 0!==n||(n=i(331047)).hash&&"b2a27d44d1f3dbd42301b82866212272"!==n.hash&&console.error("The definition of 'useCalculateMaxWidthAndHeightForSideBySideVariant_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),n);function p({pinKey:e}){let{closeupWithinMasonryEnabled:t}=(0,u.x4)(),i=(0,c.Z)(),n=(0,s.Z)(h,e),p=(0,a.Z)({showProductDetailPage:!!n?.isEligibleForPdp}),{group:m}=(0,r.Z)(),_=(0,l.useMemo)(()=>n?.carouselData?{carouselSlots:n.carouselData.carouselSlots?.map(e=>({domain:e.domain,link:e.link}))||[],index:n.carouselData.index}:void 0,[n?.carouselData]),{currentDomain:g}=(0,l.useMemo)(()=>(0,o.Z)({carouselData:_,domain:n?.domain}),[_,n?.domain]),y=(0,l.useMemo)(()=>g?g.split(".")[0]:"",[g]),f=(0,l.useMemo)(()=>{let e=n?.trackedLink||n?.link||"";return(0,d.Z)(e)??e},[n?.trackedLink,n?.link]),x=(0,l.useMemo)(()=>{let e=n?.richMetadata?.products?.[0],t=e?.offerSummary,i=!!(t?.price||t?.standardPrice),l=n?.linkDomain?.officialUser?.firstName;return{hasPrice:i,domainOwner:!!n?.closeupAttribution?.firstName||!!l,merchantName:n?.linkUserWebsite?.officialUser?.firstName||l||""}},[n?.richMetadata?.products,n?.linkDomain?.officialUser?.firstName,n?.closeupAttribution?.firstName,n?.linkUserWebsite?.officialUser?.firstName]),v=(0,l.useMemo)(()=>!!((x.merchantName||y)&&f),[x.merchantName,y,f]),b=(0,l.useMemo)(()=>{let e,t=0,i=0;return e=84+(n?.isEligibleForPdp&&x.hasPrice?18:0),t+=(n?.closeupUnifiedTitle||n?.gridTitle?23:0)+("enabled_idea_pin"!==m&&x.domainOwner?40:0),i+=64*!!v,e+=Math.max(t,i)},[n?.isEligibleForPdp,x.hasPrice,n?.closeupUnifiedTitle,n?.gridTitle,m,x.domainOwner,v]);if(!t)return{maxHeight:void 0};if(i)return{maxHeight:p?void 0:`calc(round(100vh, 1px) - 80px - ${b}px)`};let P=Math.round(window.innerHeight)-80-b;return{maxHeight:p?void 0:P}}},139707:function(e,t,i){i.d(t,{Z:()=>s});var n=i(899117),l=i(675973),o=i(15667),a=i(647709);function s(e){let{isAuthenticated:t}=(0,o.B)(),i=(0,a.HG)(),{checkExperiment:s}=(0,l.Z)(),r=t&&i&&s("closeup_dweb_peek_redesign_fast_follow").anyEnabled,d=s("closeup_dweb_peek_redesign_fast_follow").group,c=t&&i&&s("closeup_dweb_side_by_side_redesign_fast_follow").anyEnabled,u=c?s("closeup_dweb_side_by_side_redesign_fast_follow").group:"";return{peekRedesignFastFollowsExpGroup:d,peekRedesignFastFollowsEnabled:r&&(0,n.Z)(d,e),sideBySideRedesignFastFollowsExpGroup:u,sideBySideRedesignFastFollowsEnabled:c,sideBySideFullWidthCTAEnabled:"enabled_full_width_cta"===u||"employees"===u,sideBySidePWTDeferActionBarLoad:"enabled_pwt_defer_action_bar_load"===u}}},11919:function(e,t,i){i.r(t),i.d(t,{default:()=>j});var n=i(281098),l=i(667294),o=i(303151),a=i(20256),s=i(707915),r=i(856782),d=i(111330),c=i(702849),u=i(19585),h=i(369416),p=i(753143),m=i(341742),_=i(664897),g=i(790427),y=i(785893);function f({containerRef:e,onAnimationEnd:t,startAnimating:i,containerWidth:n}){let o=(0,u.ZP)(),s=(0,_.Z)(),r=(0,p.M0)(),[m,f]=(0,l.useState)(),[x,v]=(0,l.useState)(!1),[b,P]=(0,l.useState)(),S=o._('Share', 'secondarySendButtonAnimation.share', 'Share label for sharing a Pin'),w={buttonStyle:{animation:m,backgroundColor:c.Et},textStyle:{animation:b}};return(0,l.useEffect)(()=>{if(!s&&n)if(i){v(!0);let{animationSeenCount:e}=r.getItem(d.$M)||{animationSeenCount:0};r.setItem(d.$M,{animationSeenCount:e+1,lastAnimationTimestamp:Date.now()}),f("buttonSlideOut 1s ease-in forwards"),P("textFadeIn 1s ease-in forwards")}else f("buttonSlideIn .3s ease-in forwards"),P("textFadeOut .3s ease-in-out forwards")},[n,r,i,s]),(0,y.jsxs)(l.Fragment,{children:[(0,y.jsx)(h.Z,{unsafeCSS:`
@keyframes buttonSlideOut {
  0% {
    width: 48px;
  }
  15% {
    width: ${n}px;
  }
  100% {
    width: ${n}px;
  }
}

@keyframes textFadeIn {
  0% {
    opacity: 0;
  }
  15% {
    opacity: 0;
  }
  25% {
    opacity: 1;
  }
  100% {
    opacity: 1;
  }
}

@keyframes buttonSlideIn {
  0% {
    width: ${n}px;
  }
  100% {
    width: 48px;
  }
}

@keyframes textFadeOut {
  0% {
    opacity: 1;
  }
  15% {
    opacity: 1;
  }
  25% {
    opacity: 0;
  }
  100% {
    opacity: 0;
  }
}
`}),(0,y.jsx)(a.xu,{ref:e,alignItems:"center",dangerouslySetInlineStyle:{__style:{...w.buttonStyle,visibility:x?"visible":"hidden"}},display:"flex",onAnimationEnd:e=>{"buttonSlideIn"===e.animationName&&t()},position:"absolute",rounding:4,zIndex:g.mS,children:(0,y.jsxs)(a.kC,{alignItems:"center",gap:1,children:[(0,y.jsx)(a.xu,{padding:3,children:(0,y.jsx)(a.JO,{accessibilityLabel:S,color:"default",icon:"share",size:24})}),(0,y.jsx)(a.xu,{dangerouslySetInlineStyle:{__style:w.textStyle},marginEnd:3,children:(0,y.jsx)(a.mg,{size:"md",children:S})})]})})]})}function x({onAnimationEnd:e}){(0,l.useEffect)(()=>{(0,n.Z)("SecondarySendButtonAnimation","/app/common/react/components/social/SecondarySendButtonAnimation.tsx")},[]);let t=(0,l.useRef)(null),[i,o]=(0,l.useState)(0),[a,s]=(0,l.useState)(!1);return(0,m.Z)(()=>{let e=setTimeout(()=>{s(!0);let e=setTimeout(()=>{s(!1)},3e3);return()=>clearTimeout(e)},r.S+1e3);return()=>clearTimeout(e)}),(0,l.useEffect)(()=>{if(t.current&&!i&&a){let e=t.current.getBoundingClientRect().width;e&&o(e)}},[t,i,a]),(0,y.jsx)(f,{containerRef:t,containerWidth:i,onAnimationEnd:e,startAnimating:a})}var v=i(121836),b=i(207145),P=i(675973),S=i(238589),w=i(807765),k=i(74229),C=i(539532);function j({controllerOptions:e,iconColor:t,iconOnly:i,buttonText:r,showSendAnimation:c=!1,tabIndex:h=0,closeupWithinMasonryEnabled:_=!1,isInCloseupMediaViewer:g=!1}){(0,l.useEffect)(()=>{(0,n.Z)("SecondarySendButton","/app/common/react/components/social/SecondarySendButton.tsx")},[]);let f=(0,u.ZP)(),j=(0,p.M0)(),E=(0,S.Nl)(),{checkExperiment:I}=(0,P.Z)(),{setIsShowingShareButton:T}=(0,w.f)(),A=(0,l.useRef)(null),[z,F]=(0,l.useState)(c),V=g?new a.H3([k.k]):new a.Ry(5),[L]=(0,l.useState)(()=>{let e=E.getItem(v.bl)||0,{animationSeenCount:t}=j.getItem(d.$M)||{animationSeenCount:0};return t<2&&(2===e||3===e)}),M=()=>{F(!1)};return(0,m.Z)(()=>{let{lastAnimationTimestamp:e}=j.getItem(d.$M)||{lastAnimationTimestamp:0};(0,o.Z)(new Date(e),new Date)||j.setItem(d.$M,{animationSeenCount:0,lastAnimationTimestamp:e})}),(0,l.useEffect)(()=>(T(c),()=>{T(!1)}),[T,c]),(0,y.jsxs)(l.Fragment,{children:[(0,y.jsx)(C.Z,{...e,children:({handleSendShareFlyoutButtonClick:n})=>(0,y.jsxs)(a.u,{inline:!0,text:f._('Share', 'Closeup.SharePin.Icon', 'Icon for sharing the current pin'),zIndex:V,children:[z&&L&&I("sg_dweb_improved_share_animation_on_closeup").anyEnabled&&(0,y.jsx)(a.xu,{"data-test-id":"closeup-share-button",children:(0,y.jsx)(a.iP,{onTap:n,children:(0,y.jsx)(x,{onAnimationEnd:M})})}),g?(0,y.jsx)(a.zx,{ref:A,accessibilityLabel:f._('Share', 'Closeup.SharePin.AccessibilityLabel', 'Accessible label for button to share this pin'),color:"semiTransparentWhite",iconEnd:"share",onClick:n,size:"lg",tabIndex:h,text:(0,y.jsx)(a.xv,{weight:"bold",children:f._('Share', 'Closeup.SharePin.Button', 'Button to share the current pin')})}):(0,y.jsx)(s.Z,{ref:A,accessibilityLabel:f._('Send', 'Accessible label for button to send this pin', 'Accessible label for button to send this pin'),bgColor:_?"white":void 0,buttonText:r,handleClick:()=>n(),icon:"share",iconColor:t,iconOnly:i,isActive:e.isFlyoutOpen,tabIndex:h,testId:"closeup-share-button"})]})}),(0,y.jsx)(b.N,{anchors:{3017:A.current},idealDirection:"down",onAnchorTouch:"complete",placementId:12,scrollToDismiss:!0})]})}},869985:function(e,t,i){i.d(t,{Z:()=>U});var n,l,o=i(281098),a=i(667294);i(422578);var s=i(20256),r=i(592821),d=i(979904),c=i(890479),u=i(11919),h=i(980787),p=i(679422),m=i(28427),_=i(19585),g=i(601686),y=i(603316),f=i(785893);function x(e,t,i){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:n+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}let v={__style:{backgroundColor:"#000"}},b=(void 0!==n||(n=i(307595)).hash&&"e04be51b4be0a2585e7803d004fa83b7"!==n.hash&&console.error("The definition of 'CloseupVideoEndCard_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),n);class P extends a.PureComponent{constructor(...e){super(...e),x(this,"handleRestartVideo",({event:e})=>{e.stopPropagation(),this.props.onRestartVideo?.({event:e}),(0,y.nP)("web.video.endcard.share",{sampleRate:1,tags:{status:"restart",variant:"enabled_send_first"}})}),x(this,"handleShareVideo",()=>{let{clientTrackingParams:e,onToggleFlyout:t,isFlyoutOpen:i,pinId:n,requireAuth:l,logContextEvent:o}=this.props;if(i&&(0,y.nP)("web.video.endcard.share",{sampleRate:1,tags:{status:"shareSheetOpen",variant:"enabled_send_first"}}),o({event_type:101,component:179,object_id_str:n,view_type:3,view_parameter:156,element:11731,clientTrackingParams:e}),l)return void l();t&&t()}),x(this,"handleExternalSend",()=>{(0,y.nP)("web.video.endcard.share",{sampleRate:1,tags:{status:"shareSheetOpen",variant:"enabled_send_first"}})}),x(this,"renderReplayButton",()=>(0,f.jsx)(s.iP,{accessibilityLabel:this.props.i18n._('Watch again', 'Button when pressed restarts the video', 'Button when pressed restarts the video'),onTap:this.handleRestartVideo,rounding:2,children:(0,f.jsxs)(s.xu,{alignItems:"center",display:"flex",padding:2,children:[(0,f.jsx)(s.xu,{marginEnd:3,children:(0,f.jsx)(s.JO,{accessibilityLabel:this.props.i18n._('Watch again', 'Button when pressed restarts the video', 'Button when pressed restarts the video'),color:"inverse",icon:"refresh",size:18})}),(0,f.jsx)(s.X6,{color:"light",overflow:"normal",size:"400",children:this.props.i18n._('Watch again', 'Clickable label when pressed restarts the video', 'Clickable label when pressed restarts the video')})]})})),x(this,"renderShareButton",()=>{let{clientTrackingParams:e,gridDescription:t,imageSrc:i,isFlyoutOpen:n,onFlyoutDismiss:l,pinId:o}=this.props;return(0,f.jsx)(s.iP,{accessibilityLabel:this.props.i18n._('Send', 'end.video.send.icon.label', 'Clickable label when pressed opens share sheet after video is finished'),onTap:this.handleShareVideo,rounding:2,children:(0,f.jsxs)(s.xu,{alignItems:"center",display:"flex",justifyContent:"center",padding:2,children:[(0,f.jsx)(u.default,{controllerOptions:{flyoutDisplayOptions:{shownWithinMasonry:!0},loggingOptions:{component:179,element:72,onExternalSend:this.handleExternalSend,viewType:3},isFlyoutOpen:n,onFlyoutDismiss:l,onToggleFlyout:()=>{},sendObject:{type:"pin",description:t,id:o,imageUrl:i,url:`/pin/${o}/`,clientTrackingParams:e}},iconColor:"white",iconOnly:!0,tabIndex:-1}),(0,f.jsx)(s.xu,{children:(0,f.jsx)(s.X6,{color:"light",overflow:"normal",size:"400",children:this.props.i18n._('Send', 'end.video.send.icon.label', 'Clickable label when pressed opens share sheet after video is finished')})})]})})})}componentDidMount(){let{clientTrackingParams:e,pinId:t,logContextEvent:i}=this.props;(0,y.nP)("web.video.endcard.share",{sampleRate:1,tags:{status:"land",variant:"enabled_send_first"}}),i({event_type:13,component:179,object_id_str:t,view_type:3,view_parameter:156,element:11731,clientTrackingParams:e})}render(){let{backgroundImage:e,naturalHeight:t,naturalWidth:i,maxHeight:n,maxWidth:l,pinTitle:o}=this.props;return(0,f.jsx)(s.xu,{maxHeight:n,maxWidth:l,children:(0,f.jsxs)(s.Ee,{alt:o||"",naturalHeight:t,naturalWidth:i,src:e,children:[(0,f.jsx)(s.xu,{bottom:!0,dangerouslySetInlineStyle:v,left:!0,position:"absolute",right:!0,top:!0}),(0,f.jsx)(s.xu,{alignItems:"center",direction:"column",display:"flex",height:"100%",justifyContent:"center",left:!0,maxHeight:n,maxWidth:l,position:"absolute",top:!0,width:"100%",children:(0,f.jsxs)(s.xu,{position:"absolute",children:[(0,f.jsx)(s.xu,{children:this.renderShareButton()}),(0,f.jsx)(s.xu,{alignSelf:"center",children:this.renderReplayButton()})]})})]})})}}function S(e){let t;(0,a.useEffect)(()=>{(0,o.Z)("CloseupVideoEndCard","/app/common/react/components/video/closeup/CloseupVideoEndCard.tsx")},[]);let{pinKey:i,variant:n}=e,l=(0,m.Z)(b,i),{logContextEvent:s}=(0,h.u)(),c=(0,_.ZP)(),u=(0,p.Z)(),{closeupWithinMasonryEnabled:y,peekCloseupEnabled:x,viewportSize:v}=(0,g.x4)(),{maxHeight:S,fiftyPercentHeight:w,fiftyPercentWidth:k}=(0,r.Re)(),{maxHeight:C}=(0,d.Z)({pinKey:l});return x?t="sm"===v?w:S:y&&(t=C),(0,f.jsx)(P,{...e,closeupWithinMasonryEnabled:y,i18n:c,logContextEvent:s,maxHeight:"media-viewer"===n?"inherit":t,maxWidth:"media-viewer"===n?"inherit":k,requireAuth:u})}let w=({backgroundImage:e,onRestartVideo:t,pinTitle:i})=>{(0,a.useEffect)(()=>{(0,o.Z)("CloseupVideoEndCard","/app/common/react/components/video/closeup/CloseupVideoEndCard.tsx")},[]);let n=(0,_.ZP)();return(0,f.jsx)(s.xu,{"data-test-id":"video-end-card",height:"100%",width:"100%",children:(0,f.jsxs)(s.Ee,{alt:i||"",fit:"contain",naturalHeight:1,naturalWidth:1,src:e,children:[(0,f.jsx)(s.xu,{bottom:!0,dangerouslySetInlineStyle:v,left:!0,opacity:.8,position:"absolute",right:!0,top:!0}),(0,f.jsx)(s.xu,{alignItems:"center",display:"flex",height:"100%",justifyContent:"center",left:!0,position:"absolute",top:!0,width:"100%",children:(0,f.jsx)(s.xu,{children:(0,f.jsx)(s.iP,{onTap:t,rounding:2,children:(0,f.jsxs)(s.xu,{alignItems:"center",display:"flex",padding:2,children:[(0,f.jsx)(s.hU,{accessibilityLabel:n._('Replay', 'closeupVideo.endCard.ReplayButton', 'Button when pressed restarts the video'),icon:"refresh",iconColor:"white",size:"md"}),(0,f.jsx)(s.X6,{color:"light",overflow:"normal",size:"400",children:n._('Replay', 'closeupVideo.endCard.ReplayButton', 'Button when pressed restarts the video')})]})})})})]})})};var k=i(293565),C=i(392824),j=i(716920),E=i(361423),I=i(754545),T=i(956077),A=i(15667),z=i(281106),F=i(181663),V=i(123317),L=i(724084),M=i(510928),R=i(647709),Z=i(239728),B=i(104659),O=i(653621),D=i(589357),H=i(720445);function K(e,t,i){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:n+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}let W=(void 0!==l||(l=i(60533)).hash&&"53ae9ecd15f057f744460205e5d495fd"!==l.hash&&console.error("The definition of 'CloseupVideoNonDuplo_pin' appears to have changed. Run `relay-compiler` to update the generated files to receive the expected data."),l),$=(e,t)=>{t({currentTime:e?.currentTime??0,duration:e?.duration??1})};class N extends a.Component{constructor(...e){super(...e),K(this,"state",{controls:"always"===this.props.showControls&&!this.props.disabled,fullscreen:!1,playing:!(0,k.G6)(this.props.requestContext.userAgent.browserName)&&!!this.props.autoplay&&!this.props.disabled,ready:!1,seeking:!1,showEndCard:!1,volume:this.props.muted||this.props.shouldMute?0:1,videoStartTime:this.props.videoStartTime||0}),K(this,"setVideoPwtLoadingStop",(e=!1)=>{if(!E.Z)return;let{storyPinStepStopwatch:t,pinId:i}=this.props;t&&(e||t.addAnnotation("video.startup.end"),t.addBinaryAnnotation("pin.id",i,"STRING"),t.addBinaryAnnotation("video",!0,"BOOL"),t.addBinaryAnnotation("preload",e,"BOOL"),t.addSubspan({name:"perceived_video_load",endTime:E.Z.now()}),t.stop()),e||(0,C.ZP)("video.startup.end"),(0,C.L8)("perceived_video_load"),(0,T.Nx)(O._z),(0,T.rt)("pin.id",i,"STRING"),(0,T.rt)("video",!0,"BOOL"),"STORY_PIN_CLOSEUP"===(0,I.Ly)()&&(0,T.l7)(O.pM)}),K(this,"componentDidMount",()=>{let{customThumbnail:e,video:t,preferMp4:i}=this.props,{mp4:n}=t,l=t.hlsv3||t.hls||null,{thumbnail:o}=i&&n||l||{},a=(0,D.j4)(e||o);a?.ready===4&&(this.setState({ready:!0}),this.props.autoplay&&this.setVideoPwtLoadingStop(!0)),document.addEventListener("fullscreenchange",this.onFullscreenChange),document.addEventListener("webkitfullscreenchange",this.onFullscreenChange),document.addEventListener("mozfullscreenchange",this.onFullscreenChange),document.addEventListener("MSFullscreenChange",this.onFullscreenChange)}),K(this,"componentWillUnmount",()=>{document.removeEventListener("fullscreenchange",this.onFullscreenChange),document.removeEventListener("webkitfullscreenchange",this.onFullscreenChange),document.removeEventListener("mozfullscreenchange",this.onFullscreenChange),document.removeEventListener("MSFullscreenChange",this.onFullscreenChange)}),K(this,"onFullscreenChange",()=>{document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||this.props.setPanelOpen(e=>!e)}),K(this,"componentDidUpdate",(e,t)=>{this.props.videoStartTime&&this.props.videoStartTime!==e.videoStartTime&&this.setState({videoStartTime:this.props.videoStartTime}),!1===e.isPlaying&&this.props.isPlaying&&this.setState({playing:!0,controls:"never"!==this.props.showControls}),e.isPlaying&&!1===this.props.isPlaying&&this.setState({playing:!1}),e.autoplay!==this.props.autoplay&&(this.setState({playing:!!this.props.autoplay}),this.props.autoplay&&this.state.ready&&this.setVideoPwtLoadingStop(!0)),e.muted!==this.props.muted&&this.setState({volume:+!this.props.muted}),"never"===this.props.showControls&&t.controls&&this.setState({controls:!1}),(t.controls||t.playing)&&this.props.disabled&&this.setState({playing:!1,controls:!1}),!t.playing&&this.state.playing&&this.props.onPlay&&this.props.onPlay(),this.props.isCloseupMediaViewerOpen&&!e.isCloseupMediaViewerOpen&&this.setState({playing:!1})}),K(this,"handleTouch",()=>{let{seeking:e}=this.state,{disabled:t}=this.props;e||t||this.setState(e=>({playing:!e.playing}))}),K(this,"handleShowControls",()=>this.setState({controls:!0})),K(this,"handleHideControls",()=>this.setState({controls:!1})),K(this,"handleReady",()=>{let{ready:e,playing:t}=this.state,{autoplay:i,disabled:n}=this.props;i&&!e&&this.setVideoPwtLoadingStop(),this.setState({ready:!0}),(0,k.G6)(this.props.requestContext.userAgent.browserName)&&!t&&i&&!n&&this.setState({playing:!0})}),K(this,"handleEnded",({event:e})=>{let{customThumbnail:t,customEndCard:i,pinId:n,setCurrentVideo:l,loop:o,onEnded:a}=this.props;e.stopPropagation(),!o&&(this.setState({playing:!1}),t&&t.endsWith(".gif")||i||(this.setState({showEndCard:!0,videoStartTime:0}),l({pinId:n,isPromoted:!1,currentTime:0})),this.state.fullscreen&&this.exitFullscreen()),a&&a(),this.props.setPanelOpen(!0)}),K(this,"handlePause",({event:e})=>{e.stopPropagation(),this.setState({playing:!1})}),K(this,"handlePlay",({event:e})=>{e.stopPropagation(),this.setState({playing:!0})}),K(this,"handleFullscreenChange",({event:e,fullscreen:t})=>{e.stopPropagation(),this.setState({fullscreen:t})}),K(this,"handlePlayheadDown",()=>{this.setState({seeking:!0})}),K(this,"handlePlayheadUp",()=>{setTimeout(()=>{this.setState({seeking:!1})},500)}),K(this,"handleRestartVideo",({event:e})=>{e.stopPropagation(),this.setState({playing:!0,showEndCard:!1})}),K(this,"handleShareRestartVideo",({event:e})=>{e.stopPropagation(),this.setState({playing:!0,showEndCard:!1})}),K(this,"handleVolumeChange",({event:e,volume:t})=>{let{shouldMute:i}=this.props;e.stopPropagation(),i||this.setState({volume:t})}),K(this,"exitFullscreen",()=>{let{document:e}=window;(e.fullscreenElement||e.webkitFullscreenElement||e.mozFullScreenElement)&&(e.exitFullscreen?e.exitFullscreen():e.webkitExitFullscreen?e.webkitExitFullscreen():e.mozCancelFullScreen?e.mozCancelFullScreen():e.msExitFullscreen&&e.msExitFullscreen())}),K(this,"requestFullscreen",()=>{let{customThumbnail:e,video:t,preferMp4:i}=this.props,{mp4:n}=t,l=t.hlsv3||t.hls||null,{thumbnail:o}=i&&n||l||{},a=(0,D.j4)(e||o);a.requestFullscreen?a.requestFullscreen():a.webkitRequestFullscreen?a.webkitRequestFullscreen():a.mozRequestFullScreen?a.mozRequestFullScreen():a.msRequestFullscreen&&a.msRequestFullscreen()}),K(this,"renderCloseupVideoEndCard",(e,t,i,n)=>{let l={backgroundImage:e,naturalHeight:t,naturalWidth:i,onRestartVideo:this.handleShareRestartVideo},o={backgroundImage:e,naturalHeight:t,naturalWidth:i,onRestartVideo:this.handleRestartVideo},{clientTrackingParams:a,flyoutShareProps:s}=this.props,r={clientTrackingParams:a,gridDescription:s?s.gridDescription:"",imageSrc:s?s.imageSrc:"",isFlyoutOpen:!!s&&s.isFlyoutOpen,onFlyoutDismiss:s?s.onFlyoutDismiss:()=>{},onToggleFlyout:s?s.onToggleFlyout:()=>{},pinId:s?s.pinId:"",pinKey:this.props.pin,variant:this.props.variant};return n?(0,f.jsx)(w,{...o}):(0,f.jsx)(S,{...r,...l})})}render(){let{aspectRatio:e,autoplay:t,closeupStoryPinViewability:i,contextLogData:n={component:179,is_closeup_video:!0,objectId:this.props.pinId,view:3,viewParameter:156},customThumbnail:l,isPromoted:o,loop:a,objectFit:d,preferMp4:u,preload:h,requestContext:p,showControls:m,variant:_,video:g,captions:y,isDesktop:x,videoThumbnailStartTime:v,pin:b,pinId:P,setProgressInfo:S,progressInfo:w,setPanelOpen:C,panelOpen:j,setMute:E,isMuted:I,closeupWithinMasonryEnabled:T,maxHeight:A,maxWidth:L,onTimeChange:M,seekTime:R,roundingOverride:B}=this.props;n.is_closeup_video=!0;let{controls:O,fullscreen:K,playing:W,showEndCard:N,volume:U,videoStartTime:X}=this.state,q=g.hlsv3||g.hls||null;if(!q&&!g.mp4)return null;let{mp4:G}=g,J=u&&G&&G.url||q&&[{type:"video/m3u8",src:q.url}]||void 0,{height:Y,thumbnail:Q,width:ee}=u&&G||q||{},et=l||Q,ei=()=>{C&&C(!j),j&&x&&this.requestFullscreen()},en=()=>{this.setState({volume:+!!I}),E(!I)},el=()=>{this.setState({playing:!0})},eo=()=>{this.setState({playing:!1})},ea=()=>{this.setState({playing:!W})};return(0,f.jsxs)(s.zd,{height:T||"media-viewer"===_?"inherit":void 0,rounding:B,wash:!T&&"media-viewer"!==_||void 0,width:T||"media-viewer"===_?"inherit":void 0,willChangeTransform:!((0,k.G6)(p.userAgent.browserName)&&K),children:[N?this.renderCloseupVideoEndCard(et??"",Y??1,ee??1,o):(0,f.jsxs)(s.iP,{accessibilityLabel:this.props.i18n._('Pause or play video', 'pin.closeup.video.tap', 'tap area to pause or play video'),fullHeight:T||"media-viewer"===_,onMouseEnter:"hover"===m?this.handleShowControls:void 0,onMouseLeave:"hover"===m?this.handleHideControls:void 0,onTap:this.handleTouch,rounding:2,children:[(0,f.jsx)(z.Z,{playing:W,zIndexValue:99}),(0,f.jsx)(c.Z,{id:"VideoWithContextLogging",children:(0,f.jsx)(H.ZP,{aspectRatio:e??(ee??1)/(Y??1),backgroundColor:T?"black":r.yc,captions:y,closeupStoryPinViewability:i,contextLogData:{...n,video_id:this.props.video.id},hlsConfig:{startLevel:D.VS},isAutoPlay:!!t,loop:a,objectFit:d,onControlsPause:this.handlePause,onControlsPlay:this.handlePlay,onEnded:this.handleEnded,onFullscreenChange:this.handleFullscreenChange,onPlay:()=>{},onPlayError:()=>{},onPlayheadDown:this.handlePlayheadDown,onPlayheadUp:this.handlePlayheadUp,onReady:this.handleReady,onTimeChange:"storyPin"===_?M:({time:e})=>{$&&"number"==typeof G?.duration&&G.duration>0&&S&&$({currentTime:e,duration:G.duration/Z.gJ},S)},onVolumeChange:this.handleVolumeChange,pin:b,pinKey:b,playing:W,poster:et,preferMp4:u,preload:h,seekTime:R,src:J,variant:_,video:u&&G||q||{},videoStartTime:X||v,volume:U})})]}),(0,f.jsx)(s.xu,{onMouseEnter:"hover"===m?this.handleShowControls:void 0,onMouseLeave:"hover"===m?this.handleHideControls:void 0,children:"storyPin"!==_&&(0,f.jsx)(s.xu,{bottom:!0,dangerouslySetInlineStyle:{__style:{...O?{...D.Ul}:{},flexDirection:"column-reverse"}},display:"flex",height:D.hy,maxHeight:A,maxWidth:L,paddingX:6,position:"absolute",width:"100%",zIndex:V.Gf,children:(0,f.jsx)(c.Z,{id:"IdeaPinVideoScrubber",children:(0,f.jsx)(F.Z,{activePageIndex:0,captionsUrl:y,handleMute:en,handlePanelChange:ei,handlePause:eo,handlePausePlay:ea,handlePlay:el,handleWatchAgain:this.handleRestartVideo,inMilliseconds:!1,isMuted:I,isPanelOpen:j,isPlaying:W,isStoryPin:!1,pageCount:1,pages:[],pinId:P,progressInfo:w,showEndCard:N,showVideoControls:O,viewParameter:156})})})})]})}componentDidMount(){(0,o.Z)("CloseupVideo","/app/common/react/components/video/closeup/CloseupVideo.tsx")}}function U(e){(0,a.useEffect)(()=>{(0,o.Z)("CloseupVideo","/app/common/react/components/video/closeup/CloseupVideo.tsx")},[]);let{pinKey:t,pinId:i,isPromoted:n,video:l,muted:s,variant:u}=e,h=(0,m.Z)(W,t),p=(0,_.ZP)(),y=(0,A.B)(),x=(0,j.g)(),{seekTimes:v}=(0,L.Hx)(),{clientTrackingParams:b,closeupWithinMasonryEnabled:P,isCloseupMediaViewerOpen:S}=(0,g.x4)(),{maxWidth:w}=(0,r.Re)(),{appUI:k,setCurrentVideo:C}=(0,B.G)(),{videosAutoplaying:E}=k,{organicVideosAutoplaying:I,promotedVideosAutoplaying:T}=E,z=y.locale.toLowerCase(),F=(l.mp4?.captions_urls||l.hlsv3?.captions_urls)??{},V=z&&F[z]||Object.values(F)[0]||"",Z=(0,R.HG)(),O=n?T[i]:I[i],D=parseInt((0,M.Z)().t||0,10),[H,K]=(0,a.useState)(O?.currentTime||0),[$,U]=(0,a.useState)(null),[X,q]=(0,a.useState)(!0),[G,J]=(0,a.useState)(s),{maxHeight:Y}=(0,d.Z)({pinKey:h});(0,a.useEffect)(()=>{let e=H;D>0&&(e=D),v[i]&&(e=v[i]),K(e)},[v,i,D,H]);let Q=(0,a.useMemo)(()=>("default"!==u||!S)&&(!O||!O.paused),[u,O,S]);return(0,f.jsx)(c.Z,{id:"CloseupVideoInner",children:(0,f.jsx)(N,{...e,captions:String(V)||"",clientTrackingParams:b,closeupWithinMasonryEnabled:P,i18n:p,isCloseupMediaViewerOpen:S,isDesktop:Z,isMuted:G,isPanelOpen:X,isPlaying:Q,maxHeight:Y,maxWidth:"media-viewer"===u?void 0:w,panelOpen:X,pin:h,progressInfo:$,requestContext:y,seekTime:v[i],setCurrentVideo:C,setMute:J,setPanelOpen:q,setProgressInfo:U,storyPinStepStopwatch:x,variant:u,videoStartTime:H})})}K(N,"defaultProps",{loop:!1,showControls:"hover"})},974297:function(e,t,i){i.d(t,{Z:()=>n});function n(e){return e?[e["736x"],e["564x"],e["474x"],e["236x"]].find(e=>e?.url)??null:null}},607600:function(e,t,i){i.d(t,{Z:()=>a});var n=i(537347),l=i.n(n),o=i(603316);function a(e){if("undefined"==typeof window||!document.head)return(0,o.nP)("load_fonts.failure",{sampleRate:1,tags:{failure_reason:"window undefined"}}),Promise.reject(Error("Window is undefined or no head on the document. Unable to load fonts"));let{head:t}=document,i=[];return e.forEach(e=>{e.styles.forEach(n=>{let o=document.querySelector(`#${e.fontFamily??""}-${n.name}`);o||((o=document.createElement("style")).setAttribute("id",`${e.fontFamily??""}-${n.name}`),t.appendChild(o),e.format&&n.fontUrl&&o&&o.sheet&&o.sheet.insertRule(`
            @font-face {
              font-family: "${e.fontFamily??""}";
              font-style: "${n.fontStyle}";
              font-weight: "${n.fontWeight}";
              src: url("${n.fontUrl}") format("${e.format}");
            }
          `,0),i.push(new(l())(e.fontFamily,{style:n.fontStyle,weight:n.fontWeight}).load()))})}),Promise.all(i).then(()=>{Promise.resolve()}).catch(e=>{(0,o.nP)("load_fonts.failure",{sampleRate:1,tags:{failure_reason:"unsuccessful load"}}),Promise.reject(e)})}},291892:function(e,t,i){i.d(t,{Z:()=>s});var n=i(281098),l=i(667294),o=i(284778),a=i(785893);function s({alt:e,children:t,color:i,elementTiming:s,fetchPriority:r,isActive:d=!1,naturalHeight:c,naturalWidth:u,onLoad:h,src:p,fit:m="none",srcSet:_,...g}){(0,l.useEffect)(()=>{(0,n.Z)("ImageWithPerfTiming","/app/packages/pwt-logger/ImageWithPerfTiming.tsx")},[]);let y=(0,l.useRef)(null),f=(0,l.useRef)(null);return(0,l.useEffect)(()=>{if(p!==y.current||d&&d!==f.current){y.current=p??null;let e=document.querySelector(`img[src="${p}"]`)||null;e?.complete&&h()}f.current=d},[p,h,d]),(0,a.jsx)(o.Z,{...g,alt:e,color:i,elementTiming:s,fetchPriority:r,fit:m,naturalHeight:c,naturalWidth:u,onLoad:h,src:p,srcSet:_,children:t})}},716920:function(e,t,i){i.d(t,{T:()=>o,g:()=>a});let{Provider:n,get:l}=(0,i(658673).Z)({name:"story_pin_step",sampleRate:1}),o=n,a=l},281106:function(e,t,i){i.d(t,{Z:()=>c});var n=i(281098),l=i(667294),o=i(20256),a=i(883817),s=i(369416),r=i(123317),d=i(785893);function c({playing:e,zIndexValue:t}){return(0,l.useEffect)(()=>{(0,n.Z)("PausePlayOverlay","/app/packages/story-pin/Closeup/PausePlayOverlay.tsx")},[]),(0,d.jsxs)(l.Fragment,{children:[(0,d.jsx)(s.Z,{unsafeCSS:"#story-pin-closeup-pause-play-overlay svg { filter: drop-shadow( 0px 0px 8px rgba(0,0,0,0.1));}"}),(0,d.jsx)(o.xu,{alignItems:"center",bottom:!0,dangerouslySetInlineStyle:{__style:{pointerEvents:"none"}},"data-test-id":"story-pin-closeup-pause-play-overlay",display:"flex",id:"story-pin-closeup-pause-play-overlay",justifyContent:"center",left:!0,opacity:.8,position:"absolute",right:!0,rounding:r.yR,top:!0,zIndex:t?new o.Ry(t):a.p8,children:!e&&(0,d.jsx)(o.JO,{accessibilityLabel:"Play",color:"light",icon:"play",size:48})})]})}},181663:function(e,t,i){i.d(t,{Z:()=>v});var n=i(281098),l=i(667294),o=i(20256),a=i(19585),s=i(453179),r=i(579935),d=i(123317),c=i(724084),u=i(941404),h=i(572227),p=i(647709),m=i(239728),_=i(792171),g=i(601686),y=i(785893);let f=()=>{},x=({accessibilityLabel:e,dataTestId:t,disable:i,handleTap:n,icon:l})=>(0,y.jsx)(o.xu,{"data-test-id":t,opacity:i?.5:void 0,children:(0,y.jsx)(o.iP,{disabled:i,onTap:n,children:(0,y.jsx)(o.JO,{accessibilityLabel:e,color:"light",icon:l,size:16})})});function v({activePageIndex:e,handlePanelChange:t,handlePlay:i,handlePause:v,handlePausePlay:b,handleMute:P,handleVideoScrubbingNewPage:S,handleWatchAgain:w,inMilliseconds:k,isPlaying:C,isMuted:j,isPanelOpen:E,pages:I,pageCount:T,pinId:A="",progressInfo:z,showEndCard:F,showVideoControls:V=!1,viewParameter:L,isStoryPin:M=!0,captionsUrl:R=""}){(0,l.useEffect)(()=>{(0,n.Z)("IdeaPinVideoScrubber","/app/packages/story-pin/Closeup/VideoScrubber/IdeaPinVideoScrubber.tsx")},[]);let Z=(0,a.ZP)(),{currentTime:B}=z||{},{seekTimes:O}=(0,c.Hx)(),{closeupWithinMasonryEnabled:D}=(0,g.x4)(),H=(0,_.H)(),K=(0,p.HG)(),{captionsEnabled:W}=H,$=(0,h.Z)(),N=I[e],{should_mute:U}=N||j,X=Object.keys(O).includes(A)&&O[A]?O[A]:B,q=(0,l.useMemo)(()=>I.map(e=>{let t=e.blocks?.find(e=>3===e.block_type),i=t?.video?.video_list?.V_HLSV3_MOBILE?.duration||t?.video?.video_list?.V_720P?.duration;return i?{duration:i,isVideo:!0}:{duration:s.oN,isVideo:!1}}),[I]),G=[{duration:z?.duration||0,isVideo:!0}],J=M?q:G,Y=(N&&N.blocks?.[0]||{}).video?.video_list?.V_HLSV3_MOBILE?.captions_urls,Q=!1;(Y&&0!==Object.keys(Y).length||R)&&(Q=!0);let ee=(0,l.useMemo)(()=>J.reduce((e,t)=>e+(t.duration||0),0)/(M?m.gJ:1),[J,M]),et=(0,l.useMemo)(()=>J.filter((t,i)=>i<e).reduce((e,t)=>e+(t.duration||0),0)/m.gJ,[J,e]),ei=J.length>0&&J[e]?.isVideo?B??0:(B??0)*5+(et??0),en=Z._('Hide captions', 'gestalt.video.accessibilityHideCaptionsLabel', 'ARIA label for hide captions button'),el=Z._('Show captions', 'gestalt.video.accessibilityShowCaptionsLabel', 'ARIA label for show captions button');return(0,y.jsxs)(o.xu,{alignContent:"evenly",alignItems:"baseline",dangerouslySetInlineStyle:{__style:{gap:"18.5px",pointerEvents:"auto"}},direction:"column",display:"flex",justifyContent:"between",width:"100%",children:[(0,y.jsxs)(o.xu,{alignItems:"center",dangerouslySetInlineStyle:{__style:{opacity:V||!C?1:0,transition:"all .1s"}},direction:"row",display:"flex",justifyContent:"between",width:"99%",children:[(0,y.jsxs)(o.kC,{alignItems:"center",direction:"row",gap:5,children:[(0,y.jsx)(x,{accessibilityLabel:C?Z._('Pause', 'closeup.IdeaPinVideo.Pause', 'Pause button on Idea Pin video'):Z._('Play', 'closeup.IdeaPinVideo.Play', 'Play button on Idea Pin video'),dataTestId:`story-pin-closeup-${C?"pause":"play"}`,handleTap:F&&w?w:b,icon:C?"pause":"play"}),z&&(0,y.jsx)(o.iP,{children:(0,y.jsxs)(o.xu,{"aria-label":`${Z._('Video duration', 'closeup.IdeaPinVideo.durationLabel', 'Screen reader label for video duration display')}: ${(0,d.Lc)(ei)} of ${(0,d.Lc)(ee)}`,"data-test-id":"time-display",children:[(0,y.jsx)(o.xv,{align:"end",color:"inverse",inline:!0,overflow:"normal",size:"300",weight:"bold",children:`${(0,d.Lc)(ei)}`})," ",(0,y.jsx)(o.xu,{display:"inlineBlock",opacity:.6,children:(0,y.jsx)(o.xv,{align:"end",color:"inverse",inline:!0,overflow:"normal",size:"300",weight:"bold",children:`/ ${(0,d.Lc)(ee)}`})})]})})]}),(0,y.jsxs)(o.kC,{direction:"row",gap:5,children:[Q&&(0,y.jsx)(x,{accessibilityLabel:W?el:en,dataTestId:`closed-captions-button-${W?"disable":"enable"}`,handleTap:()=>{let e=K?"desktop_pin_page":"mweb_pin_page";W?(0,u.My)(`${e}.closed_captions_button.toggle_off`):(0,u.My)(`${e}.closed_captions_button.toggle_on`),$({action:"click",item:"closed-captions-button"}),H.setCaptionsEnabled(!W)},icon:W?"captions":"captions-outline"}),(0,y.jsx)(x,{accessibilityLabel:j?Z._('Unmute', 'closeup.IdeaPinVideo.unmute', 'Unmute button on Idea Pin video'):Z._('Mute', 'closeup.IdeaPinVideo.mute', 'Mute button on Idea Pin video'),dataTestId:`story-pin-closeup-${j?"unmute":"mute"}`,disable:U,handleTap:P,icon:j?"mute":"sound"}),t&&!D&&(0,y.jsx)(x,{accessibilityLabel:E?Z._('Maximize', 'closeup.IdeaPinVideo.maximize', 'Maximize button on Idea Pin video'):Z._('Minimize', 'closeup.IdeaPinVideo.minimize', 'Minimize button on Idea Pin video'),dataTestId:`story-pin-closeup-${E?"maximize":"minimize"}`,handleTap:t||f,icon:E?"maximize":"minimize"})]})]}),(0,y.jsx)(r.ZP,{activePageCurrentTime:X,activePageIndex:e,duration:ee,handlePause:v,handlePlay:i,handleVideoScrubbingNewPage:S,inMilliseconds:k,isPlaying:C,pageCount:T,pageDurations:J,pinId:A,progressInfo:z,shouldShowPlayhead:!0,showEndCard:F,showVideoControls:V,videoDurations:J,viewParameter:L})]})}},579935:function(e,t,i){i.d(t,{$:()=>g,$E:()=>_,ZP:()=>v});var n=i(281098),l=i(667294),o=i(20256),a=i(521009),s=i(19585),r=i(453179),d=i(15667),c=i(785893);function u({pillHeight:e,scrubberWidth:t}){return(0,l.useEffect)(()=>{(0,n.Z)("PaginationProgressPill","/app/packages/story-pin/Closeup/VideoScrubber/PaginationProgressPill.tsx")},[]),(0,c.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:{backgroundColor:_}},display:"flex",flex:"grow",height:e,overflow:"hidden",rounding:"pill",children:(0,c.jsx)(o.xu,{color:g,dangerouslySetInlineStyle:{__style:{width:t}},"data-test-id":"video-progress-bar",height:"100%",rounding:"pill"})})}var h=i(724084),p=i(647709),m=i(239728);let _="rgba(255,255,255,0.24)",g="light",y=()=>{},f=({children:e,setHoveringChange:t,handleMouseDown:i,handleMouseLeave:n,handleTouchStart:l,playhead:a,isPlaying:r,showVideoControls:d})=>{let u=(0,s.ZP)(),h=!(0,p.HG)();return(0,c.jsx)(o.iP,{children:(0,c.jsx)(o.xu,{ref:a,alignItems:"center","aria-label":u._('Video scrubber progress bar', 'ideaPin.closeupvideo.videoScrubberLabel', 'Accessibility label for video scrubber progress bar on video idea pins.'),dangerouslySetInlineStyle:{__style:{pointerEvents:"auto",touchAction:"none"}},"data-test-id":"bullet-video-progress-bar",display:"flex",flex:"grow",justifyContent:h?"center":"start",marginBottom:6*!h,minHeight:"8px",onFocus:t(!0),onMouseDown:i,onMouseLeave:n,onMouseOver:t(!0),onTouchEnd:e=>e.preventDefault(),onTouchStart:l,opacity:d||!r?1:0,paddingY:6*!!h,position:"relative",role:"progressbar",width:"100%",children:e})})},x=({isRTL:e,isSeeking:t,scrubberWidth:i})=>(0,c.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:e?{right:i}:{left:i}},"data-test-id":"video-progress-bar-playhead",position:"relative",children:(0,c.jsx)(o.xu,{color:g,height:4,position:"absolute",rounding:"pill",children:(0,c.jsx)(o.xu,{color:"light",dangerouslySetInlineStyle:{__style:{marginTop:t?-8:-6}},height:t?16:12,marginStart:-2,rounding:"circle",width:t?16:12})})});function v({activePageIndex:e,activePageCurrentTime:t,pageCount:i,progressInfo:s,showEndCard:_,duration:v=0,pageDurations:b=[],handlePlay:P=y,handlePause:S=y,handleVideoScrubbingNewPage:w=y,inMilliseconds:k,videoDurations:C=[],viewParameter:j,isInactiveStreamPin:E=!1,isPlaying:I=!1,setVideoProgress:T,shouldShowPlayhead:A=!1,showVideoControls:z=!0,pinId:F=""}){(0,l.useEffect)(()=>{(0,n.Z)("Pagination","/app/packages/story-pin/Closeup/VideoScrubber/Pagination.tsx")},[]);let V=!(0,p.HG)(),L=(0,l.useRef)(null),{isRTL:M}=(0,d.B)(),[R,Z]=(0,l.useState)(!1),[B,O]=(0,l.useState)(I),[D,H]=(0,l.useState)(),K=(0,a.Z)(),[W,$]=(0,l.useState)(!1),{clearSeekTime:N,updateSeekTime:U}=(0,h.RC)(),X=(0,l.useCallback)((t,n)=>{if(!E&&n<=i){if(n!==e&&w(n),T){let{isVideo:e}=C[n];T({currentTime:t/1e3,duration:e?s?.duration??1:s?.duration??5,pinId:F})}U(t/1e3,F)}K({event_type:101,view_type:3,view_parameter:j,component:14302})},[e,w,E,K,i,F,s?.duration,T,U,C,j]),q=b.map(e=>`${(e.duration||0)/v/10}%`),G=(0,l.useMemo)(()=>{let e=0;return b.map(({duration:t})=>{let i=t+e,n={min:e,max:i};return e=i,n})},[b]),J=R?"0 1.2px":"0 1px",Y=e=>()=>Z(e),Q=(0,l.useCallback)(e=>{if(!L.current)return;let{left:t=0,right:i=0,width:n=0}=L.current.getBoundingClientRect(),l=(M?Math.max(0,Math.min((i-e)/n,1)):Math.max(0,Math.min((e-t)/n,1)))*v*1e3,o=G.findIndex(e=>l>=e.min&&l<=e.max),a=-1===o?0:o;X(l-G[a].min,a)},[v,X,G,M]),ee=(0,l.useCallback)(()=>{W||O(I||_),$(!0)},[W,O,I,_]),et=(0,l.useCallback)(e=>{ee(),I&&S(),Q(e.pageX)},[ee,I,S,Q]),ei=(0,l.useCallback)(e=>{W&&Q(e.pageX)},[Q,W]),en=(0,l.useCallback)(e=>{if(W){e.preventDefault();let t=Array.from(e.changedTouches).find(e=>e.identifier===D);t&&Q(t.pageX)}},[W,Q,D]),el=(0,l.useCallback)(()=>{Y(!1),H(void 0),$(!1),B&&P()},[P,B]),eo=(0,l.useCallback)(e=>{Array.from(e.changedTouches).find(e=>e.identifier===D)&&(Y(!1),H(void 0),$(!1),N()),B&&P()},[N,P,B,D]);return(0,l.useEffect)(()=>(W&&!E&&(window.addEventListener("mousemove",ei),window.addEventListener("mouseup",el),window.addEventListener("touchmove",en),window.addEventListener("touchend",eo)),()=>{window.removeEventListener("mousemove",ei),window.removeEventListener("mouseup",el),window.removeEventListener("touchmove",en),window.removeEventListener("touchend",eo)}),[ei,el,eo,en,E,W,Q,B,D]),(0,c.jsx)(f,{handleMouseDown:et,handleMouseLeave:()=>{Y(!1)},handleTouchStart:e=>{ee(),Y(!0);let t=e.changedTouches[0];H(t.identifier),Q(t.pageX)},isPlaying:I,playhead:L,setHoveringChange:Y,showVideoControls:z,children:Array(i).fill(void 0).map((n,l)=>{let a=s?.currentTime??0,d=s?.duration??r.P6,h=C[l],p=`${h?.isVideo&&k?Math.floor(1e4*(t??a)/(h.duration/m.gJ))/100:a/d*100}%`;return(0,c.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:{margin:J}},flex:"grow",width:q.length===i?q[l]:"auto",children:(0,c.jsx)(o.xu,{dangerouslySetInlineStyle:{__style:{transition:"all .1s"}},"data-test-id":"idea-pin-video-progress-bar",rounding:"pill",children:l<e||_?(0,c.jsx)(o.xu,{color:g,height:4,rounding:"pill"}):e===l&&s?(0,c.jsxs)(o.kC,{alignItems:"center",flex:"grow",children:[A&&(z||R||W||V)&&(0,c.jsx)(x,{isRTL:M,isSeeking:W,scrubberWidth:p}),(0,c.jsx)(u,{pillHeight:4,scrubberWidth:p})]}):(0,c.jsx)(o.xu,{color:g,dangerouslySetInlineStyle:{__style:{opacity:.24}},height:4,rounding:"pill"})})},`${F}-${l}`)})})}},445698:function(e,t,i){i.d(t,{BN:()=>c,RK:()=>d,d3:()=>h,tq:()=>p,xm:()=>u});var n=i(667294),l=i(607600),o=i(123317),a=i(543561),s=i(341742);let r=(e,t)=>{let i=(0,o.pE)(e,t);return`${i.y}px ${i.x}px`},d=({alignment:e,verticalAlignment:t})=>{let i={alignItems:"flex-start",display:"flex",height:"100%",justifyContent:"start",textAlign:"left",width:"100%"};return 1===t?i.alignItems="center":2===t&&(i.alignItems="flex-end"),1===e&&(i.justifyContent="center",i.textAlign="center"),i},c=({fontSize:e,hexColor:t,highlightColor:i,letterSpacing:n,lineHeight:l,name:o})=>({fontSize:e,letterSpacing:n,color:t,fontFamily:o,margin:0,maxHeight:"100%",textShadow:!i&&t&&"#ffffff"===t.toLowerCase()?"0px 1px 4px rgba(0, 0, 0, 0.2)":void 0,wordBreak:"break-word",...i?{backgroundColor:i,borderRadius:e/5,padding:r(e,l)}:{}}),u=({fontSize:e,hasText:t,highlightColor:i,lineHeight:n})=>({...i?{backgroundColor:t?i:void 0,borderRadius:e/5,padding:r(e,n)}:{}}),h=({letterSpacing:e,lineHeight:t,name:i,url:n})=>({fontFamily:i,fontGroup:"",fontOverrides:{letterSpacing:e,lineHeight:t,textTransform:!1},format:"truetype",defaultStyle:0,styles:[{name:"Regular",fontStyle:"",fontWeight:"normal",fontUrl:n}]});function p({hasPin:e,pages:t,limitToSingleFont:i}){let[r,d]=(0,n.useState)(!1),[c,u]=(0,n.useState)(()=>!!e&&(0,a.X7)(t)),p=()=>{let e=t.reduce((e,t)=>{let n=t?.blocks?.filter(e=>[o.h8.PARAGRAPH,o.h8.HEADING].includes(e.type))||[];return i&&n.length>1&&(n=[n[0]]),n.forEach(t=>{let i=t.style?.font||o.Cc.font,{name:n=""}=i;e[n]||(e[n]=i)}),e},{});if(Object.keys(e).length>0){let t=Object.keys(e).map(t=>{let i=e[t];return h({letterSpacing:i.letter_spacing,lineHeight:i.line_height,name:i.name,url:i.url})});(0,l.Z)(t),d(!0)}};return(0,s.Z)(()=>{p()}),(0,s.Z)(()=>{c||p()}),(0,n.useEffect)(()=>{c||u((0,a.X7)(t))},[c,t]),{fontsLoaded:r,mediaDataReceived:c}}},294711:function(e,t,i){i.d(t,{Z:()=>n});function n({currentTime:e,endTime:t,startTime:i}){return"number"!=typeof i||"number"!=typeof t||!(i>=0)||!(t>0)||!(i<t)||i<=e&&e<=t}},543561:function(e,t,i){i.d(t,{B7:()=>a,X7:()=>s,n4:()=>o});var n=i(123317);function l(e,t,i){var n;return(t="symbol"==typeof(n=function(e,t){if("object"!=typeof e||!e)return e;var i=e[Symbol.toPrimitive];if(void 0!==i){var n=i.call(e,t||"default");if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(t,"string"))?n:n+"")in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}let o=(e,t)=>{let i=/^\d{1,3}\.\d{1,3}(?:\.\d{1,6})?$/;if(!e?.match(i)||!t?.match(i))return null;let n=e?.split("."),l=t?.split("."),o=Math.max((n??"").length,(l??"").length);for(let e=0;e<o;e+=1){let t=e<(n?.length??0)?parseInt(n?.[e]??"",10):0,i=e<(l?.length??0)?parseInt(l?.[e]??"",10):0;if(t<i)return -1;if(t>i)return 1}return 0};class a{constructor(e,t,i){if(l(this,"start",Date.now()),l(this,"paused",!1),this.onProgress=e,this.onComplete=t,this.duration=i,this.remaining=i,"undefined"==typeof window)return;this.intervalId=window.setInterval(()=>{let e=this.paused?this.duration-this.remaining:this.duration-this.remaining+(Date.now()-this.start);this.onProgress(e/this.duration)},500),this.resume()}currentTime(){return this.duration-this.remaining}pause(){this.paused=!0,window.clearTimeout(this.timerId),this.remaining-=Date.now()-this.start;let e=this.duration-this.remaining;this.onProgress(e/this.duration)}resume(){this.paused=!1,this.start=Date.now(),window.clearTimeout(this.timerId),this.timerId=window.setTimeout(this.onComplete,this.remaining)}clear(){window.clearTimeout(this.timerId),window.clearInterval(this.intervalId)}}function s(e){return e.some(e=>(e?.blocks??[]).some(e=>e.type===n.h8.IMAGE&&!!e.image||e.type===n.h8.VIDEO&&(!!e.video||!!e.video_signature)))}},644493:function(e,t,i){i.d(t,{Z:()=>n});function n(e){try{return decodeURIComponent(e)}catch{return null}}},399806:function(e,t,i){i.d(t,{Q:()=>n,Z:()=>l});let n=()=>{let e,t="undefined"!=typeof window?window.navigator?.connection?.effectiveType:void 0,i=!window?.devicePixelRatio||window.devicePixelRatio<=1?"1x":"2x";return t?"4g"===t?e="40-80":(i="1x",e="0-1"):e="unknown",{downloadSpeedGroup:e,screenDimension:i}};function l(e){let{vHLSV3MOBILE:t,...i}=e,l=function({vEXP3:e,vEXP4:t,vEXP5:i,vEXP6:l,vEXP7:o,v720P:a}){let{downloadSpeedGroup:s,screenDimension:r}=n(),d={"1x":e,"2x":i},c={"1x":o,"2x":o};return({unknown:d,"0-1":d,"1-5":{"1x":t,"2x":i},"5-10":{"1x":i,"2x":i},"10-20":{"1x":l,"2x":l},"20-40":c,"40-80":c,"80_or_above":c})[s][r]||a||void 0}(i),o=t||void 0;return l?{hlsv3:o,mp4:l}:{hlsv3:o}}},807765:function(e,t,i){i.d(t,{c:()=>r,f:()=>s});var n=i(667294),l=i(729434),o=i(785893);let{Provider:a,get:s}=(0,l.Z)("CloseupAnimations");function r({children:e}){let[t,i]=(0,n.useState)(!1),[l,s]=(0,n.useState)(!1),r=(0,n.useMemo)(()=>({isShowingShareButton:t,setIsShowingShareButton:i,isShowingVisualSearchButton:l,setIsShowingVisualSearchButton:s}),[t,l]);return(0,o.jsx)(a,{value:r,children:e})}},218831:function(e,t,i){i.d(t,{C:()=>r,K:()=>s});var n=i(281098),l=i(667294),o=i(785893);let a=(0,l.createContext)({closeupBodyWidth:0,isCollageOverlayOpen:!1,isRelatedPins10PercentVisible:!1,setCloseupBodyWidth:()=>{},setIsCollageOverlayOpen:()=>{},setIsRelatedPins10PercentVisible:()=>{}});function s(){let e=(0,l.useContext)(a);if(!e)throw Error("useCloseupBodyContext must be used within CloseupBodyContextProvider");return e}function r({children:e}){(0,l.useEffect)(()=>{(0,n.Z)("Context","/app/www/closeup/desktop/CloseupBody/Context.tsx")},[]);let[t,i]=(0,l.useState)(0),[s,r]=(0,l.useState)(!1),[d,c]=(0,l.useState)(!1),u=(0,l.useMemo)(()=>({closeupBodyWidth:t,setCloseupBodyWidth:i,isCollageOverlayOpen:s,setIsCollageOverlayOpen:r,isRelatedPins10PercentVisible:d,setIsRelatedPins10PercentVisible:c}),[t,s,d]);return(0,o.jsx)(a,{value:u,children:e})}},653621:function(e,t,i){let n;i.d(t,{GL:()=>a,_z:()=>l,d0:()=>r,hO:()=>s,pM:()=>o});let l="video",o="image",a=new Map([["DEFAULT",new Set(["button"])],["story_pin",new Set([l])],["product_detail_page",new Set(["description","shopButton","thumbnailsLoaded"])],["product_detail_page_plus",new Set(["description","shopButton","thumbnailsLoaded"])]]),s=(n=new Set,a.forEach(e=>{n=new Set([...n,...e])}),n),r=new Set([...s,o,"resource"])},452750:function(e,t,i){i.d(t,{Z:()=>l});var n=i(640785);function l(e){return{defaultStyle:0,fontFamily:e.name??"",fontGroup:n.gu,fontOverrides:{letterSpacing:e.letter_spacing,lineHeight:e.line_height},format:"truetype",id:e.id,styles:[{fontStyle:"",fontUrl:e.url,fontWeight:"normal",name:"normal"}]}}}}]);
//# sourceMappingURL=https://sm.pinimg.com/webapp/45591-bd88b8e355f0bb51.mjs.map